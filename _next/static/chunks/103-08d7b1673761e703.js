"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[103],{8734:function(t,e,n){n.d(e,{OH:function(){return w},vc:function(){return Yt},q_:function(){return nn}});var r=n(1451),i=n(7294);function o(){}const s={arr:Array.isArray,obj:t=>!!t&&"Object"===t.constructor.name,fun:t=>"function"===typeof t,str:t=>"string"===typeof t,num:t=>"number"===typeof t,und:t=>void 0===t};function a(t,e){if(s.arr(t)){if(!s.arr(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return t===e}const u=(t,e)=>t.forEach(e);function c(t,e,n){if(s.arr(t))for(let r=0;r<t.length;r++)e.call(n,t[r],`${r}`);else for(const r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r)}const l=t=>s.und(t)?[]:s.arr(t)?t:[t];function h(t,e){if(t.size){const n=Array.from(t);t.clear(),u(n,e)}}const f=(t,...e)=>h(t,(t=>t(...e))),p=()=>"undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent);let d,m,g=null,v=!1,y=o;var w=Object.freeze({__proto__:null,get createStringInterpolator(){return d},get to(){return m},get colors(){return g},get skipAnimation(){return v},get willAdvance(){return y},assign:t=>{t.to&&(m=t.to),t.now&&(r.W.now=t.now),void 0!==t.colors&&(g=t.colors),null!=t.skipAnimation&&(v=t.skipAnimation),t.createStringInterpolator&&(d=t.createStringInterpolator),t.requestAnimationFrame&&r.W.use(t.requestAnimationFrame),t.batchedUpdates&&(r.W.batchedUpdates=t.batchedUpdates),t.willAdvance&&(y=t.willAdvance),t.frameLoop&&(r.W.frameLoop=t.frameLoop)}});const b=new Set;let x=[],I=[],M=0;const A={get idle(){return!b.size&&!x.length},start(t){M>t.priority?(b.add(t),r.W.onStart(P)):(k(t),(0,r.W)(T))},advance:T,sort(t){if(M)r.W.onFrame((()=>A.sort(t)));else{const e=x.indexOf(t);~e&&(x.splice(e,1),E(t))}},clear(){x=[],b.clear()}};function P(){b.forEach(k),b.clear(),(0,r.W)(T)}function k(t){x.includes(t)||E(t)}function E(t){x.splice(function(t,e){const n=t.findIndex(e);return n<0?t.length:n}(x,(e=>e.priority>t.priority)),0,t)}function T(t){const e=I;for(let n=0;n<x.length;n++){const r=x[n];M=r.priority,r.idle||(y(r),r.advance(t),r.idle||e.push(r))}return M=0,I=x,I.length=0,x=e,x.length>0}const _="[-+]?\\d*\\.?\\d+",S=_+"%";function C(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}const O=new RegExp("rgb"+C(_,_,_)),F=new RegExp("rgba"+C(_,_,_,_)),L=new RegExp("hsl"+C(_,S,S)),R=new RegExp("hsla"+C(_,S,S,_)),D=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,j=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,V=/^#([0-9a-fA-F]{6})$/,N=/^#([0-9a-fA-F]{8})$/;function z(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function U(t,e,n){const r=n<.5?n*(1+e):n+e-n*e,i=2*n-r,o=z(i,r,t+1/3),s=z(i,r,t),a=z(i,r,t-1/3);return Math.round(255*o)<<24|Math.round(255*s)<<16|Math.round(255*a)<<8}function B(t){const e=parseInt(t,10);return e<0?0:e>255?255:e}function W(t){return(parseFloat(t)%360+360)%360/360}function G(t){const e=parseFloat(t);return e<0?0:e>1?255:Math.round(255*e)}function q(t){const e=parseFloat(t);return e<0?0:e>100?1:e/100}function $(t){let e=function(t){let e;return"number"===typeof t?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=V.exec(t))?parseInt(e[1]+"ff",16)>>>0:g&&void 0!==g[t]?g[t]:(e=O.exec(t))?(B(e[1])<<24|B(e[2])<<16|B(e[3])<<8|255)>>>0:(e=F.exec(t))?(B(e[1])<<24|B(e[2])<<16|B(e[3])<<8|G(e[4]))>>>0:(e=D.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=N.exec(t))?parseInt(e[1],16)>>>0:(e=j.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=L.exec(t))?(255|U(W(e[1]),q(e[2]),q(e[3])))>>>0:(e=R.exec(t))?(U(W(e[1]),q(e[2]),q(e[3]))|G(e[4]))>>>0:null}(t);return null===e?t:(e=e||0,`rgba(${(4278190080&e)>>>24}, ${(16711680&e)>>>16}, ${(65280&e)>>>8}, ${(255&e)/255})`)}const X=(t,e,n)=>{if(s.fun(t))return t;if(s.arr(t))return X({range:t,output:e,extrapolate:n});if(s.str(t.output[0]))return d(t);const r=t,i=r.output,o=r.range||[0,1],a=r.extrapolateLeft||r.extrapolate||"extend",u=r.extrapolateRight||r.extrapolate||"extend",c=r.easing||(t=>t);return t=>{const e=function(t,e){for(var n=1;n<e.length-1&&!(e[n]>=t);++n);return n-1}(t,o);return function(t,e,n,r,i,o,s,a,u){let c=u?u(t):t;if(c<e){if("identity"===s)return c;"clamp"===s&&(c=e)}if(c>n){if("identity"===a)return c;"clamp"===a&&(c=n)}if(r===i)return r;if(e===n)return t<=e?r:i;e===-1/0?c=-c:n===1/0?c-=e:c=(c-e)/(n-e);c=o(c),r===-1/0?c=-c:i===1/0?c+=r:c=c*(i-r)+r;return c}(t,o[e],o[e+1],i[e],i[e+1],c,a,u,r.map)}};function H(){return(H=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}const Q=Symbol.for("FluidValue.get"),Z=Symbol.for("FluidValue.observers"),K=t=>Boolean(t&&t[Q]),Y=t=>t&&t[Q]?t[Q]():t,J=t=>t[Z]||null;function tt(t,e){let n=t[Z];n&&n.forEach((t=>{!function(t,e){t.eventObserved?t.eventObserved(e):t(e)}(t,e)}))}const et=(t,e)=>it(t,Q,e);function nt(t,e){if(t[Q]){let n=t[Z];n||it(t,Z,n=new Set),n.has(e)||(n.add(e),t.observerAdded&&t.observerAdded(n.size,e))}return e}function rt(t,e){let n=t[Z];if(n&&n.has(e)){const r=n.size-1;r?n.delete(e):t[Z]=null,t.observerRemoved&&t.observerRemoved(r,e)}}const it=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),ot=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,st=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,at=new RegExp(`(${ot.source})(%|[a-z]+)`,"i"),ut=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,ct=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,lt=t=>{const[e,n]=ht(t);if(!e||p())return t;const r=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(r)return r.trim();if(n&&n.startsWith("--")){const e=window.getComputedStyle(document.documentElement).getPropertyValue(n);return e||t}return n&&ct.test(n)?lt(n):n||t},ht=t=>{const e=ct.exec(t);if(!e)return[,];const[,n,r]=e;return[n,r]};let ft;const pt=(t,e,n,r,i)=>`rgba(${Math.round(e)}, ${Math.round(n)}, ${Math.round(r)}, ${i})`,dt="react-spring: ",mt=t=>{const e=t;let n=!1;if("function"!=typeof e)throw new TypeError(`${dt}once requires a function parameter`);return(...t)=>{n||(e(...t),n=!0)}},gt=mt(console.warn);const vt=mt(console.warn);function yt(t){return s.str(t)&&("#"==t[0]||/\d/.test(t)||!p()&&ct.test(t)||t in(g||{}))}const wt=t=>(0,i.useEffect)(t,bt),bt=[];function xt(){const t=(0,i.useState)()[1],e=(0,i.useState)(It)[0];return wt(e.unmount),()=>{e.current&&t({})}}function It(){const t={current:!0,unmount:()=>()=>{t.current=!1}};return t}function Mt(t){const e=(0,i.useRef)();return(0,i.useEffect)((()=>{e.current=t})),e.current}const At="undefined"!==typeof window&&window.document&&window.document.createElement?i.useLayoutEffect:i.useEffect,Pt=Symbol.for("Animated:node"),kt=t=>t&&t[Pt],Et=(t,e)=>{return n=t,r=Pt,i=e,Object.defineProperty(n,r,{value:i,writable:!0,configurable:!0});var n,r,i},Tt=t=>t&&t[Pt]&&t[Pt].getPayload();class _t{constructor(){this.payload=void 0,Et(this,this)}getPayload(){return this.payload||[]}}class St extends _t{constructor(t){super(),this.done=!0,this.elapsedTime=void 0,this.lastPosition=void 0,this.lastVelocity=void 0,this.v0=void 0,this.durationProgress=0,this._value=t,s.num(this._value)&&(this.lastPosition=this._value)}static create(t){return new St(t)}getPayload(){return[this]}getValue(){return this._value}setValue(t,e){return s.num(t)&&(this.lastPosition=t,e&&(t=Math.round(t/e)*e,this.done&&(this.lastPosition=t))),this._value!==t&&(this._value=t,!0)}reset(){const{done:t}=this;this.done=!1,s.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,t&&(this.lastVelocity=null),this.v0=null)}}class Ct extends St{constructor(t){super(0),this._string=null,this._toString=void 0,this._toString=X({output:[t,t]})}static create(t){return new Ct(t)}getValue(){let t=this._string;return null==t?this._string=this._toString(this._value):t}setValue(t){if(s.str(t)){if(t==this._string)return!1;this._string=t,this._value=1}else{if(!super.setValue(t))return!1;this._string=null}return!0}reset(t){t&&(this._toString=X({output:[this.getValue(),t]})),this._value=0,super.reset()}}const Ot={dependencies:null};class Ft extends _t{constructor(t){super(),this.source=t,this.setValue(t)}getValue(t){const e={};return c(this.source,((n,r)=>{var i;(i=n)&&i[Pt]===i?e[r]=n.getValue(t):K(n)?e[r]=Y(n):t||(e[r]=n)})),e}setValue(t){this.source=t,this.payload=this._makePayload(t)}reset(){this.payload&&u(this.payload,(t=>t.reset()))}_makePayload(t){if(t){const e=new Set;return c(t,this._addToPayload,e),Array.from(e)}}_addToPayload(t){Ot.dependencies&&K(t)&&Ot.dependencies.add(t);const e=Tt(t);e&&u(e,(t=>this.add(t)))}}class Lt extends Ft{constructor(t){super(t)}static create(t){return new Lt(t)}getValue(){return this.source.map((t=>t.getValue()))}setValue(t){const e=this.getPayload();return t.length==e.length?e.map(((e,n)=>e.setValue(t[n]))).some(Boolean):(super.setValue(t.map(Rt)),!0)}}function Rt(t){return(yt(t)?Ct:St).create(t)}function Dt(t){const e=kt(t);return e?e.constructor:s.arr(t)?Lt:yt(t)?Ct:St}Symbol.for("AnimatedComponent");function jt(){return(jt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Vt(t,...e){return s.fun(t)?t(...e):t}const Nt=(t,e)=>!0===t||!!(e&&t&&(s.fun(t)?t(e):l(t).includes(e))),zt=(t,e)=>s.obj(t)?e&&t[e]:t,Ut=(t,e)=>!0===t.default?t[e]:t.default?t.default[e]:void 0,Bt=t=>t,Wt=(t,e=Bt)=>{let n=Gt;t.default&&!0!==t.default&&(t=t.default,n=Object.keys(t));const r={};for(const i of n){const n=e(t[i],i);s.und(n)||(r[i]=n)}return r},Gt=["config","onProps","onStart","onChange","onPause","onResume","onRest"],qt={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function $t(t){const e=function(t){const e={};let n=0;if(c(t,((t,r)=>{qt[r]||(e[r]=t,n++)})),n)return e}(t);if(e){const n={to:e};return c(t,((t,r)=>r in e||(n[r]=t))),n}return jt({},t)}function Xt(t){return t=Y(t),s.arr(t)?t.map(Xt):yt(t)?w.createStringInterpolator({range:[0,1],output:[t,t]})(1):t}function Ht(t){for(const e in t)return!0;return!1}function Qt(t){return s.fun(t)||s.arr(t)&&s.obj(t[0])}function Zt(t,e){var n;null==(n=t.ref)||n.delete(t),null==e||e.delete(t)}function Kt(t,e){var n;e&&t.ref!==e&&(null==(n=t.ref)||n.delete(t),e.add(t),t.ref=e)}const Yt={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},Jt=1.70158,te=1.525*Jt,ee=Jt+1,ne=2*Math.PI/3,re=2*Math.PI/4.5,ie=t=>{const e=7.5625,n=2.75;return t<1/n?e*t*t:t<2/n?e*(t-=1.5/n)*t+.75:t<2.5/n?e*(t-=2.25/n)*t+.9375:e*(t-=2.625/n)*t+.984375},oe={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>1-(1-t)*(1-t),easeInOutQuad:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeInCubic:t=>t*t*t,easeOutCubic:t=>1-Math.pow(1-t,3),easeInOutCubic:t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1-Math.pow(1-t,4),easeInOutQuart:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1-Math.pow(1-t,5),easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>0===t?0:Math.pow(2,10*t-10),easeOutExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>0===t?0:1===t?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeInCirc:t=>1-Math.sqrt(1-Math.pow(t,2)),easeOutCirc:t=>Math.sqrt(1-Math.pow(t-1,2)),easeInOutCirc:t=>t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2,easeInBack:t=>ee*t*t*t-Jt*t*t,easeOutBack:t=>1+ee*Math.pow(t-1,3)+Jt*Math.pow(t-1,2),easeInOutBack:t=>t<.5?Math.pow(2*t,2)*(7.189819*t-te)/2:(Math.pow(2*t-2,2)*((te+1)*(2*t-2)+te)+2)/2,easeInElastic:t=>0===t?0:1===t?1:-Math.pow(2,10*t-10)*Math.sin((10*t-10.75)*ne),easeOutElastic:t=>0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin((10*t-.75)*ne)+1,easeInOutElastic:t=>0===t?0:1===t?1:t<.5?-Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*re)/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*re)/2+1,easeInBounce:t=>1-ie(1-t),easeOutBounce:ie,easeInOutBounce:t=>t<.5?(1-ie(1-2*t))/2:(1+ie(2*t-1))/2},se=jt({},Yt.default,{mass:1,damping:1,easing:oe.linear,clamp:!1});class ae{constructor(){this.tension=void 0,this.friction=void 0,this.frequency=void 0,this.damping=void 0,this.mass=void 0,this.velocity=0,this.restVelocity=void 0,this.precision=void 0,this.progress=void 0,this.duration=void 0,this.easing=void 0,this.clamp=void 0,this.bounce=void 0,this.decay=void 0,this.round=void 0,Object.assign(this,se)}}function ue(t,e){if(s.und(e.decay)){const n=!s.und(e.tension)||!s.und(e.friction);!n&&s.und(e.frequency)&&s.und(e.damping)&&s.und(e.mass)||(t.duration=void 0,t.decay=void 0),n&&(t.frequency=void 0)}else t.duration=void 0}const ce=[];class le{constructor(){this.changed=!1,this.values=ce,this.toValues=null,this.fromValues=ce,this.to=void 0,this.from=void 0,this.config=new ae,this.immediate=!1}}function he(t,{key:e,props:n,defaultProps:i,state:o,actions:a}){return new Promise(((u,c)=>{var l;let h,f,p=Nt(null!=(l=n.cancel)?l:null==i?void 0:i.cancel,e);if(p)g();else{s.und(n.pause)||(o.paused=Nt(n.pause,e));let t=null==i?void 0:i.pause;!0!==t&&(t=o.paused||Nt(t,e)),h=Vt(n.delay||0,e),t?(o.resumeQueue.add(m),a.pause()):(a.resume(),m())}function d(){o.resumeQueue.add(m),o.timeouts.delete(f),f.cancel(),h=f.time-r.W.now()}function m(){h>0&&!w.skipAnimation?(o.delayed=!0,f=r.W.setTimeout(g,h),o.pauseQueue.add(d),o.timeouts.add(f)):g()}function g(){o.delayed&&(o.delayed=!1),o.pauseQueue.delete(d),o.timeouts.delete(f),t<=(o.cancelId||0)&&(p=!0);try{a.start(jt({},n,{callId:t,cancel:p}),u)}catch(e){c(e)}}}))}const fe=(t,e)=>1==e.length?e[0]:e.some((t=>t.cancelled))?me(t.get()):e.every((t=>t.noop))?pe(t.get()):de(t.get(),e.every((t=>t.finished))),pe=t=>({value:t,noop:!0,finished:!0,cancelled:!1}),de=(t,e,n=!1)=>({value:t,finished:e,cancelled:n}),me=t=>({value:t,cancelled:!0,finished:!1});function ge(t,e,n,i){const{callId:o,parentId:a,onRest:u}=e,{asyncTo:l,promise:h}=n;return a||t!==l||e.reset?n.promise=(async()=>{n.asyncId=o,n.asyncTo=t;const f=Wt(e,((t,e)=>"onRest"===e?void 0:t));let p,d;const m=new Promise(((t,e)=>(p=t,d=e))),g=t=>{const e=o<=(n.cancelId||0)&&me(i)||o!==n.asyncId&&de(i,!1);if(e)throw t.result=e,d(t),t},v=(t,e)=>{const r=new ye,a=new we;return(async()=>{if(w.skipAnimation)throw ve(n),a.result=de(i,!1),d(a),a;g(r);const u=s.obj(t)?jt({},t):jt({},e,{to:t});u.parentId=o,c(f,((t,e)=>{s.und(u[e])&&(u[e]=t)}));const l=await i.start(u);return g(r),n.paused&&await new Promise((t=>{n.resumeQueue.add(t)})),l})()};let y;if(w.skipAnimation)return ve(n),de(i,!1);try{let e;e=s.arr(t)?(async t=>{for(const e of t)await v(e)})(t):Promise.resolve(t(v,i.stop.bind(i))),await Promise.all([e.then(p),m]),y=de(i.get(),!0,!1)}catch(b){if(b instanceof ye)y=b.result;else{if(!(b instanceof we))throw b;y=b.result}}finally{o==n.asyncId&&(n.asyncId=a,n.asyncTo=a?l:void 0,n.promise=a?h:void 0)}return s.fun(u)&&r.W.batchedUpdates((()=>{u(y,i,i.item)})),y})():h}function ve(t,e){h(t.timeouts,(t=>t.cancel())),t.pauseQueue.clear(),t.resumeQueue.clear(),t.asyncId=t.asyncTo=t.promise=void 0,e&&(t.cancelId=e)}class ye extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise."),this.result=void 0}}class we extends Error{constructor(){super("SkipAnimationSignal"),this.result=void 0}}const be=t=>t instanceof Ie;let xe=1;class Ie extends class{constructor(t){if(this[Q]=void 0,this[Z]=void 0,!t&&!(t=this.get))throw Error("Unknown getter");et(this,t)}}{constructor(...t){super(...t),this.id=xe++,this.key=void 0,this._priority=0}get priority(){return this._priority}set priority(t){this._priority!=t&&(this._priority=t,this._onPriorityChange(t))}get(){const t=kt(this);return t&&t.getValue()}to(...t){return w.to(this,t)}interpolate(...t){return gt(`${dt}The "interpolate" function is deprecated in v9 (use "to" instead)`),w.to(this,t)}toJSON(){return this.get()}observerAdded(t){1==t&&this._attach()}observerRemoved(t){0==t&&this._detach()}_attach(){}_detach(){}_onChange(t,e=!1){tt(this,{type:"change",parent:this,value:t,idle:e})}_onPriorityChange(t){this.idle||A.sort(this),tt(this,{type:"priority",parent:this,priority:t})}}const Me=Symbol.for("SpringPhase"),Ae=t=>(1&t[Me])>0,Pe=t=>(2&t[Me])>0,ke=t=>(4&t[Me])>0,Ee=(t,e)=>e?t[Me]|=3:t[Me]&=-3,Te=(t,e)=>e?t[Me]|=4:t[Me]&=-5;class _e extends Ie{constructor(t,e){if(super(),this.key=void 0,this.animation=new le,this.queue=void 0,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!s.und(t)||!s.und(e)){const n=s.obj(t)?jt({},t):jt({},e,{from:t});s.und(n.default)&&(n.default=!0),this.start(n)}}get idle(){return!(Pe(this)||this._state.asyncTo)||ke(this)}get goal(){return Y(this.animation.to)}get velocity(){const t=kt(this);return t instanceof St?t.lastVelocity||0:t.getPayload().map((t=>t.lastVelocity||0))}get hasAnimated(){return Ae(this)}get isAnimating(){return Pe(this)}get isPaused(){return ke(this)}get isDelayed(){return this._state.delayed}advance(t){let e=!0,n=!1;const r=this.animation;let{config:i,toValues:o}=r;const a=Tt(r.to);!a&&K(r.to)&&(o=l(Y(r.to))),r.values.forEach(((u,c)=>{if(u.done)return;const l=u.constructor==Ct?1:a?a[c].lastPosition:o[c];let h=r.immediate,f=l;if(!h){if(f=u.lastPosition,i.tension<=0)return void(u.done=!0);let e=u.elapsedTime+=t;const n=r.fromValues[c],o=null!=u.v0?u.v0:u.v0=s.arr(i.velocity)?i.velocity[c]:i.velocity;let a;if(s.und(i.duration))if(i.decay){const t=!0===i.decay?.998:i.decay,r=Math.exp(-(1-t)*e);f=n+o/(1-t)*(1-r),h=Math.abs(u.lastPosition-f)<.1,a=o*r}else{a=null==u.lastVelocity?o:u.lastVelocity;const e=i.precision||(n==l?.005:Math.min(1,.001*Math.abs(l-n))),r=i.restVelocity||e/10,c=i.clamp?0:i.bounce,p=!s.und(c),d=n==l?u.v0>0:n<l;let m,g=!1;const v=1,y=Math.ceil(t/v);for(let t=0;t<y&&(m=Math.abs(a)>r,m||(h=Math.abs(l-f)<=e,!h));++t){p&&(g=f==l||f>l==d,g&&(a=-a*c,f=l));a+=(1e-6*-i.tension*(f-l)+.001*-i.friction*a)/i.mass*v,f+=a*v}}else{let r=1;i.duration>0&&(this._memoizedDuration!==i.duration&&(this._memoizedDuration=i.duration,u.durationProgress>0&&(u.elapsedTime=i.duration*u.durationProgress,e=u.elapsedTime+=t)),r=(i.progress||0)+e/this._memoizedDuration,r=r>1?1:r<0?0:r,u.durationProgress=r),f=n+i.easing(r)*(l-n),a=(f-u.lastPosition)/t,h=1==r}u.lastVelocity=a,Number.isNaN(f)&&(console.warn("Got NaN while animating:",this),h=!0)}a&&!a[c].done&&(h=!1),h?u.done=!0:e=!1,u.setValue(f,i.round)&&(n=!0)}));const u=kt(this),c=u.getValue();if(e){const t=Y(r.to);c===t&&!n||i.decay?n&&i.decay&&this._onChange(c):(u.setValue(t),this._onChange(t)),this._stop()}else n&&this._onChange(c)}set(t){return r.W.batchedUpdates((()=>{this._stop(),this._focus(t),this._set(t)})),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(Pe(this)){const{to:t,config:e}=this.animation;r.W.batchedUpdates((()=>{this._onStart(),e.decay||this._set(t,!1),this._stop()}))}return this}update(t){return(this.queue||(this.queue=[])).push(t),this}start(t,e){let n;return s.und(t)?(n=this.queue||[],this.queue=[]):n=[s.obj(t)?t:jt({},e,{to:t})],Promise.all(n.map((t=>this._update(t)))).then((t=>fe(this,t)))}stop(t){const{to:e}=this.animation;return this._focus(this.get()),ve(this._state,t&&this._lastCallId),r.W.batchedUpdates((()=>this._stop(e,t))),this}reset(){this._update({reset:!0})}eventObserved(t){"change"==t.type?this._start():"priority"==t.type&&(this.priority=t.priority+1)}_prepareNode(t){const e=this.key||"";let{to:n,from:r}=t;n=s.obj(n)?n[e]:n,(null==n||Qt(n))&&(n=void 0),r=s.obj(r)?r[e]:r,null==r&&(r=void 0);const i={to:n,from:r};return Ae(this)||(t.reverse&&([n,r]=[r,n]),r=Y(r),s.und(r)?kt(this)||this._set(n):this._set(r)),i}_update(t,e){let n=jt({},t);const{key:r,defaultProps:i}=this;n.default&&Object.assign(i,Wt(n,((t,e)=>/^on/.test(e)?zt(t,r):t))),De(this,n,"onProps"),je(this,"onProps",n,this);const o=this._prepareNode(n);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const s=this._state;return he(++this._lastCallId,{key:r,props:n,defaultProps:i,state:s,actions:{pause:()=>{ke(this)||(Te(this,!0),f(s.pauseQueue),je(this,"onPause",de(this,Se(this,this.animation.to)),this))},resume:()=>{ke(this)&&(Te(this,!1),Pe(this)&&this._resume(),f(s.resumeQueue),je(this,"onResume",de(this,Se(this,this.animation.to)),this))},start:this._merge.bind(this,o)}}).then((t=>{if(n.loop&&t.finished&&(!e||!t.noop)){const t=Ce(n);if(t)return this._update(t,!0)}return t}))}_merge(t,e,n){if(e.cancel)return this.stop(!0),n(me(this));const i=!s.und(t.to),o=!s.und(t.from);if(i||o){if(!(e.callId>this._lastToId))return n(me(this));this._lastToId=e.callId}const{key:c,defaultProps:h,animation:p}=this,{to:d,from:m}=p;let{to:g=d,from:v=m}=t;!o||i||e.default&&!s.und(g)||(g=v),e.reverse&&([g,v]=[v,g]);const y=!a(v,m);y&&(p.from=v),v=Y(v);const w=!a(g,d);w&&this._focus(g);const b=Qt(e.to),{config:x}=p,{decay:I,velocity:M}=x;(i||o)&&(x.velocity=0),e.config&&!b&&function(t,e,n){n&&(ue(n=jt({},n),e),e=jt({},n,e)),ue(t,e),Object.assign(t,e);for(const s in se)null==t[s]&&(t[s]=se[s]);let{mass:r,frequency:i,damping:o}=t;s.und(i)||(i<.01&&(i=.01),o<0&&(o=0),t.tension=Math.pow(2*Math.PI/i,2)*r,t.friction=4*Math.PI*o*r/i)}(x,Vt(e.config,c),e.config!==h.config?Vt(h.config,c):void 0);let A=kt(this);if(!A||s.und(g))return n(de(this,!0));const P=s.und(e.reset)?o&&!e.default:!s.und(v)&&Nt(e.reset,c),k=P?v:this.get(),E=Xt(g),T=s.num(E)||s.arr(E)||yt(E),_=!b&&(!T||Nt(h.immediate||e.immediate,c));if(w){const t=Dt(g);if(t!==A.constructor){if(!_)throw Error(`Cannot animate between ${A.constructor.name} and ${t.name}, as the "to" prop suggests`);A=this._set(E)}}const S=A.constructor;let C=K(g),O=!1;if(!C){const t=P||!Ae(this)&&y;(w||t)&&(O=a(Xt(k),E),C=!O),(a(p.immediate,_)||_)&&a(x.decay,I)&&a(x.velocity,M)||(C=!0)}if(O&&Pe(this)&&(p.changed&&!P?C=!0:C||this._stop(d)),!b&&((C||K(d))&&(p.values=A.getPayload(),p.toValues=K(g)?null:S==Ct?[1]:l(E)),p.immediate!=_&&(p.immediate=_,_||P||this._set(d)),C)){const{onRest:t}=p;u(Re,(t=>De(this,e,t)));const i=de(this,Se(this,d));f(this._pendingCalls,i),this._pendingCalls.add(n),p.changed&&r.W.batchedUpdates((()=>{p.changed=!P,null==t||t(i,this),P?Vt(h.onRest,i):null==p.onStart||p.onStart(i,this)}))}P&&this._set(k),b?n(ge(e.to,e,this._state,this)):C?this._start():Pe(this)&&!w?this._pendingCalls.add(n):n(pe(k))}_focus(t){const e=this.animation;t!==e.to&&(J(this)&&this._detach(),e.to=t,J(this)&&this._attach())}_attach(){let t=0;const{to:e}=this.animation;K(e)&&(nt(e,this),be(e)&&(t=e.priority+1)),this.priority=t}_detach(){const{to:t}=this.animation;K(t)&&rt(t,this)}_set(t,e=!0){const n=Y(t);if(!s.und(n)){const t=kt(this);if(!t||!a(n,t.getValue())){const i=Dt(n);t&&t.constructor==i?t.setValue(n):Et(this,i.create(n)),t&&r.W.batchedUpdates((()=>{this._onChange(n,e)}))}}return kt(this)}_onStart(){const t=this.animation;t.changed||(t.changed=!0,je(this,"onStart",de(this,Se(this,t.to)),this))}_onChange(t,e){e||(this._onStart(),Vt(this.animation.onChange,t,this)),Vt(this.defaultProps.onChange,t,this),super._onChange(t,e)}_start(){const t=this.animation;kt(this).reset(Y(t.to)),t.immediate||(t.fromValues=t.values.map((t=>t.lastPosition))),Pe(this)||(Ee(this,!0),ke(this)||this._resume())}_resume(){w.skipAnimation?this.finish():A.start(this)}_stop(t,e){if(Pe(this)){Ee(this,!1);const n=this.animation;u(n.values,(t=>{t.done=!0})),n.toValues&&(n.onChange=n.onPause=n.onResume=void 0),tt(this,{type:"idle",parent:this});const r=e?me(this.get()):de(this.get(),Se(this,null!=t?t:n.to));f(this._pendingCalls,r),n.changed&&(n.changed=!1,je(this,"onRest",r,this))}}}function Se(t,e){const n=Xt(e);return a(Xt(t.get()),n)}function Ce(t,e=t.loop,n=t.to){let r=Vt(e);if(r){const i=!0!==r&&$t(r),o=(i||t).reverse,s=!i||i.reset;return Oe(jt({},t,{loop:e,default:!1,pause:void 0,to:!o||Qt(n)?n:void 0,from:s?t.from:void 0,reset:s},i))}}function Oe(t){const{to:e,from:n}=t=$t(t),r=new Set;return s.obj(e)&&Le(e,r),s.obj(n)&&Le(n,r),t.keys=r.size?Array.from(r):null,t}function Fe(t){const e=Oe(t);return s.und(e.default)&&(e.default=Wt(e)),e}function Le(t,e){c(t,((t,n)=>null!=t&&e.add(n)))}const Re=["onStart","onRest","onChange","onPause","onResume"];function De(t,e,n){t.animation[n]=e[n]!==Ut(e,n)?zt(e[n],t.key):void 0}function je(t,e,...n){var r,i,o,s;null==(r=(i=t.animation)[e])||r.call(i,...n),null==(o=(s=t.defaultProps)[e])||o.call(s,...n)}const Ve=["onStart","onChange","onRest"];let Ne=1;class ze{constructor(t,e){this.id=Ne++,this.springs={},this.queue=[],this.ref=void 0,this._flush=void 0,this._initialProps=void 0,this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._item=void 0,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),e&&(this._flush=e),t&&this.start(jt({default:!0},t))}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every((t=>t.idle&&!t.isDelayed&&!t.isPaused))}get item(){return this._item}set item(t){this._item=t}get(){const t={};return this.each(((e,n)=>t[n]=e.get())),t}set(t){for(const e in t){const n=t[e];s.und(n)||this.springs[e].set(n)}}update(t){return t&&this.queue.push(Oe(t)),this}start(t){let{queue:e}=this;return t?e=l(t).map(Oe):this.queue=[],this._flush?this._flush(this,e):(Xe(this,e),Ue(this,e))}stop(t,e){if(t!==!!t&&(e=t),e){const n=this.springs;u(l(e),(e=>n[e].stop(!!t)))}else ve(this._state,this._lastAsyncId),this.each((e=>e.stop(!!t)));return this}pause(t){if(s.und(t))this.start({pause:!0});else{const e=this.springs;u(l(t),(t=>e[t].pause()))}return this}resume(t){if(s.und(t))this.start({pause:!1});else{const e=this.springs;u(l(t),(t=>e[t].resume()))}return this}each(t){c(this.springs,t)}_onFrame(){const{onStart:t,onChange:e,onRest:n}=this._events,r=this._active.size>0,i=this._changed.size>0;(r&&!this._started||i&&!this._started)&&(this._started=!0,h(t,(([t,e])=>{e.value=this.get(),t(e,this,this._item)})));const o=!r&&this._started,s=i||o&&n.size?this.get():null;i&&e.size&&h(e,(([t,e])=>{e.value=s,t(e,this,this._item)})),o&&(this._started=!1,h(n,(([t,e])=>{e.value=s,t(e,this,this._item)})))}eventObserved(t){if("change"==t.type)this._changed.add(t.parent),t.idle||this._active.add(t.parent);else{if("idle"!=t.type)return;this._active.delete(t.parent)}r.W.onFrame(this._onFrame)}}function Ue(t,e){return Promise.all(e.map((e=>Be(t,e)))).then((e=>fe(t,e)))}async function Be(t,e,n){const{keys:i,to:a,from:c,loop:l,onRest:h,onResolve:p}=e,d=s.obj(e.default)&&e.default;l&&(e.loop=!1),!1===a&&(e.to=null),!1===c&&(e.from=null);const m=s.arr(a)||s.fun(a)?a:void 0;m?(e.to=void 0,e.onRest=void 0,d&&(d.onRest=void 0)):u(Ve,(n=>{const r=e[n];if(s.fun(r)){const i=t._events[n];e[n]=({finished:t,cancelled:e})=>{const n=i.get(r);n?(t||(n.finished=!1),e&&(n.cancelled=!0)):i.set(r,{value:null,finished:t||!1,cancelled:e||!1})},d&&(d[n]=e[n])}}));const g=t._state;e.pause===!g.paused?(g.paused=e.pause,f(e.pause?g.pauseQueue:g.resumeQueue)):g.paused&&(e.pause=!0);const v=(i||Object.keys(t.springs)).map((n=>t.springs[n].start(e))),y=!0===e.cancel||!0===Ut(e,"cancel");(m||y&&g.asyncId)&&v.push(he(++t._lastAsyncId,{props:e,state:g,actions:{pause:o,resume:o,start(e,n){y?(ve(g,t._lastAsyncId),n(me(t))):(e.onRest=h,n(ge(m,e,g,t)))}}})),g.paused&&await new Promise((t=>{g.resumeQueue.add(t)}));const w=fe(t,await Promise.all(v));if(l&&w.finished&&(!n||!w.noop)){const n=Ce(e,l,a);if(n)return Xe(t,[n]),Be(t,n,!0)}return p&&r.W.batchedUpdates((()=>p(w,t,t.item))),w}function We(t,e){const n=jt({},t.springs);return e&&u(l(e),(t=>{s.und(t.keys)&&(t=Oe(t)),s.obj(t.to)||(t=jt({},t,{to:void 0})),$e(n,t,(t=>qe(t)))})),Ge(t,n),n}function Ge(t,e){c(e,((e,n)=>{t.springs[n]||(t.springs[n]=e,nt(e,t))}))}function qe(t,e){const n=new _e;return n.key=t,e&&nt(n,e),n}function $e(t,e,n){e.keys&&u(e.keys,(r=>{(t[r]||(t[r]=n(r)))._prepareNode(e)}))}function Xe(t,e){u(e,(e=>{$e(t.springs,e,(e=>qe(e,t)))}))}function He(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}const Qe=["children"],Ze=t=>{let{children:e}=t,n=He(t,Qe);const r=(0,i.useContext)(Ke),o=n.pause||!!r.pause,s=n.immediate||!!r.immediate;n=function(t,e){const[n]=(0,i.useState)((()=>({inputs:e,result:t()}))),r=(0,i.useRef)(),o=r.current;let s=o;s?Boolean(e&&s.inputs&&function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}(e,s.inputs))||(s={inputs:e,result:t()}):s=n;return(0,i.useEffect)((()=>{r.current=s,o==n&&(n.inputs=n.result=void 0)}),[s]),s.result}((()=>({pause:o,immediate:s})),[o,s]);const{Provider:a}=Ke;return i.createElement(a,{value:n},e)},Ke=(Ye=Ze,Je={},Object.assign(Ye,i.createContext(Je)),Ye.Provider._context=Ye,Ye.Consumer._context=Ye,Ye);var Ye,Je;Ze.Provider=Ke.Provider,Ze.Consumer=Ke.Consumer;const tn=()=>{const t=[],e=function(e){vt(`${dt}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`);const r=[];return u(t,((t,i)=>{if(s.und(e))r.push(t.start());else{const o=n(e,t,i);o&&r.push(t.start(o))}})),r};e.current=t,e.add=function(e){t.includes(e)||t.push(e)},e.delete=function(e){const n=t.indexOf(e);~n&&t.splice(n,1)},e.pause=function(){return u(t,(t=>t.pause(...arguments))),this},e.resume=function(){return u(t,(t=>t.resume(...arguments))),this},e.set=function(e){u(t,(t=>t.set(e)))},e.start=function(e){const n=[];return u(t,((t,r)=>{if(s.und(e))n.push(t.start());else{const i=this._getProps(e,t,r);i&&n.push(t.start(i))}})),n},e.stop=function(){return u(t,(t=>t.stop(...arguments))),this},e.update=function(e){return u(t,((t,n)=>t.update(this._getProps(e,t,n)))),this};const n=function(t,e,n){return s.fun(t)?t(n,e):t};return e._getProps=n,e};function en(t,e,n){const r=s.fun(e)&&e;r&&!n&&(n=[]);const o=(0,i.useMemo)((()=>r||3==arguments.length?tn():void 0),[]),a=(0,i.useRef)(0),c=xt(),l=(0,i.useMemo)((()=>({ctrls:[],queue:[],flush(t,e){const n=We(t,e);return a.current>0&&!l.queue.length&&!Object.keys(n).some((e=>!t.springs[e]))?Ue(t,e):new Promise((r=>{Ge(t,n),l.queue.push((()=>{r(Ue(t,e))})),c()}))}})),[]),h=(0,i.useRef)([...l.ctrls]),f=[],p=Mt(t)||0;function d(t,n){for(let i=t;i<n;i++){const t=h.current[i]||(h.current[i]=new ze(null,l.flush)),n=r?r(i,t):e[i];n&&(f[i]=Fe(n))}}(0,i.useMemo)((()=>{u(h.current.slice(t,p),(t=>{Zt(t,o),t.stop(!0)})),h.current.length=t,d(p,t)}),[t]),(0,i.useMemo)((()=>{d(0,Math.min(p,t))}),n);const m=h.current.map(((t,e)=>We(t,f[e]))),g=(0,i.useContext)(Ze),v=Mt(g),y=g!==v&&Ht(g);At((()=>{a.current++,l.ctrls=h.current;const{queue:t}=l;t.length&&(l.queue=[],u(t,(t=>t()))),u(h.current,((t,e)=>{null==o||o.add(t),y&&t.start({default:g});const n=f[e];n&&(Kt(t,n.ref),t.ref?t.queue.push(n):t.start(n))}))})),wt((()=>()=>{u(l.ctrls,(t=>t.stop(!0)))}));const w=m.map((t=>jt({},t)));return o?[w,o]:w}function nn(t,e){const n=s.fun(t),[[r],i]=en(1,n?t:[t],n?e||[]:e);return n||2==arguments.length?[r,i]:r}let rn;!function(t){t.MOUNT="mount",t.ENTER="enter",t.UPDATE="update",t.LEAVE="leave"}(rn||(rn={}));class on extends Ie{constructor(t,e){super(),this.key=void 0,this.idle=!0,this.calc=void 0,this._active=new Set,this.source=t,this.calc=X(...e);const n=this._get(),r=Dt(n);Et(this,r.create(n))}advance(t){const e=this._get();a(e,this.get())||(kt(this).setValue(e),this._onChange(e,this.idle)),!this.idle&&an(this._active)&&un(this)}_get(){const t=s.arr(this.source)?this.source.map(Y):l(Y(this.source));return this.calc(...t)}_start(){this.idle&&!an(this._active)&&(this.idle=!1,u(Tt(this),(t=>{t.done=!1})),w.skipAnimation?(r.W.batchedUpdates((()=>this.advance())),un(this)):A.start(this))}_attach(){let t=1;u(l(this.source),(e=>{K(e)&&nt(e,this),be(e)&&(e.idle||this._active.add(e),t=Math.max(t,e.priority+1))})),this.priority=t,this._start()}_detach(){u(l(this.source),(t=>{K(t)&&rt(t,this)})),this._active.clear(),un(this)}eventObserved(t){"change"==t.type?t.idle?this.advance():(this._active.add(t.parent),this._start()):"idle"==t.type?this._active.delete(t.parent):"priority"==t.type&&(this.priority=l(this.source).reduce(((t,e)=>Math.max(t,(be(e)?e.priority:0)+1)),0))}}function sn(t){return!1!==t.idle}function an(t){return!t.size||Array.from(t).every(sn)}function un(t){t.idle||(t.idle=!0,u(Tt(t),(t=>{t.done=!0})),tt(t,{type:"idle",parent:t}))}w.assign({createStringInterpolator:t=>{ft||(ft=g?new RegExp(`(${Object.keys(g).join("|")})(?!\\w)`,"g"):/^\b$/);const e=t.output.map((t=>Y(t).replace(ct,lt).replace(st,$).replace(ft,$))),n=e.map((t=>t.match(ot).map(Number))),r=n[0].map(((t,e)=>n.map((t=>{if(!(e in t))throw Error('The arity of each "output" value must be equal');return t[e]})))).map((e=>X(H({},t,{output:e}))));return t=>{var n;const i=!at.test(e[0])&&(null==(n=e.find((t=>at.test(t))))?void 0:n.replace(ot,""));let o=0;return e[0].replace(ot,(()=>`${r[o++](t)}${i||""}`)).replace(ut,pt)}},to:(t,e)=>new on(t,e)});A.advance},1451:function(t,e,n){n.d(e,{W:function(){return i}});let r=w();const i=t=>m(t,r);let o=w();i.write=t=>m(t,o);let s=w();i.onStart=t=>m(t,s);let a=w();i.onFrame=t=>m(t,a);let u=w();i.onFinish=t=>m(t,u);let c=[];i.setTimeout=(t,e)=>{let n=i.now()+e,r=()=>{let t=c.findIndex((t=>t.cancel==r));~t&&c.splice(t,1),p-=~t?1:0},o={time:n,handler:t,cancel:r};return c.splice(l(n),0,o),p+=1,g(),o};let l=t=>~(~c.findIndex((e=>e.time>t))||~c.length);i.cancel=t=>{s.delete(t),a.delete(t),r.delete(t),o.delete(t),u.delete(t)},i.sync=t=>{d=!0,i.batchedUpdates(t),d=!1},i.throttle=t=>{let e;function n(){try{t(...e)}finally{e=null}}function r(...t){e=t,i.onStart(n)}return r.handler=t,r.cancel=()=>{s.delete(n),e=null},r};let h="undefined"!=typeof window?window.requestAnimationFrame:()=>{};i.use=t=>h=t,i.now="undefined"!=typeof performance?()=>performance.now():Date.now,i.batchedUpdates=t=>t(),i.catch=console.error,i.frameLoop="always",i.advance=()=>{"demand"!==i.frameLoop?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):y()};let f=-1,p=0,d=!1;function m(t,e){d?(e.delete(t),t(0)):(e.add(t),g())}function g(){f<0&&(f=0,"demand"!==i.frameLoop&&h(v))}function v(){~f&&(h(v),i.batchedUpdates(y))}function y(){let t=f;f=i.now();let e=l(f);e&&(b(c.splice(0,e),(t=>t.handler())),p-=e),s.flush(),r.flush(t?Math.min(64,f-t):16.667),a.flush(),o.flush(),u.flush(),p||(f=-1)}function w(){let t=new Set,e=t;return{add(n){p+=e!=t||t.has(n)?0:1,t.add(n)},delete:n=>(p-=e==t&&t.has(n)?1:0,t.delete(n)),flush(n){e.size&&(t=new Set,p-=e.size,b(e,(e=>e(n)&&t.add(e))),p+=t.size,e=t)}}}function b(t,e){t.forEach((t=>{try{e(t)}catch(n){i.catch(n)}}))}},5449:function(t,e,n){n.d(e,{config:function(){return i.vc},useSpring:function(){return i.q_},q:function(){return c}});var r=n(5147),i=n(8734),o=n(1457),s=n(4510),a=n(2212);const u=["primitive"].concat(Object.keys(a).filter((t=>/^[A-Z]/.test(t))).map((t=>t[0].toLowerCase()+t.slice(1))));i.OH.assign({createStringInterpolator:o.qS,colors:o.O9,frameLoop:"demand"}),(0,r.gy)((()=>{o.Wn.advance()}));const c=(0,s.Ld)(u,{applyAnimatedValues:r.nH}).animated},4510:function(t,e,n){n.d(e,{Ld:function(){return p}});var r=n(1457),i=n(7294);const o=Symbol.for("Animated:node");class s{constructor(){var t,e;this.payload=void 0,t=this,e=this,(0,r.dE)(t,o,e)}getPayload(){return this.payload||[]}}const a={dependencies:null};class u extends s{constructor(t){super(),this.source=t,this.setValue(t)}getValue(t){const e={};return(0,r.rU)(this.source,((n,i)=>{var s;(s=n)&&s[o]===s?e[i]=n.getValue(t):(0,r.j$)(n)?e[i]=(0,r.je)(n):t||(e[i]=n)})),e}setValue(t){this.source=t,this.payload=this._makePayload(t)}reset(){this.payload&&(0,r.S6)(this.payload,(t=>t.reset()))}_makePayload(t){if(t){const e=new Set;return(0,r.rU)(t,this._addToPayload,e),Array.from(e)}}_addToPayload(t){a.dependencies&&(0,r.j$)(t)&&a.dependencies.add(t);const e=(n=t)&&n[o]&&n[o].getPayload();var n;e&&(0,r.S6)(e,(t=>this.add(t)))}}function c(){return(c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}const l=(t,e)=>{const n=!r.is.fun(t)||t.prototype&&t.prototype.isReactComponent;return(0,i.forwardRef)(((o,s)=>{const l=(0,i.useRef)(null),f=n&&(0,i.useCallback)((t=>{l.current=function(t,e){t&&(r.is.fun(t)?t(e):t.current=e);return e}(s,t)}),[s]),[p,d]=function(t,e){const n=new Set;a.dependencies=n,t.style&&(t=c({},t,{style:e.createAnimatedStyle(t.style)}));return t=new u(t),a.dependencies=null,[t,n]}(o,e),m=(0,r.NW)(),g=()=>{const t=l.current;if(n&&!t)return;!1===(!!t&&e.applyAnimatedValues(t,p.getValue(!0)))&&m()},v=new h(g,d),y=(0,i.useRef)();(0,r.bt)((()=>{const t=y.current;y.current=v,(0,r.S6)(d,(t=>(0,r.UI)(t,v))),t&&((0,r.S6)(t.deps,(e=>(0,r.iL)(e,t))),r.Wn.cancel(t.update))})),(0,i.useEffect)(g,[]),(0,r.tf)((()=>()=>{const t=y.current;(0,r.S6)(t.deps,(e=>(0,r.iL)(e,t)))}));const w=e.getComponentProps(p.getValue());return i.createElement(t,c({},w,{ref:f}))}))};class h{constructor(t,e){this.update=t,this.deps=e}eventObserved(t){"change"==t.type&&r.Wn.write(this.update)}}const f=Symbol.for("AnimatedComponent"),p=(t,{applyAnimatedValues:e=(()=>!1),createAnimatedStyle:n=(t=>new u(t)),getComponentProps:i=(t=>t)}={})=>{const o={applyAnimatedValues:e,createAnimatedStyle:n,getComponentProps:i},s=t=>{const e=d(t)||"Anonymous";return(t=r.is.str(t)?s[t]||(s[t]=l(t,o)):t[f]||(t[f]=l(t,o))).displayName=`Animated(${e})`,t};return(0,r.rU)(t,((e,n)=>{r.is.arr(t)&&(n=d(e)),s[n]=s(e)})),{animated:s}},d=t=>r.is.str(t)?t:t&&r.is.str(t.displayName)?t.displayName:r.is.fun(t)&&t.name||null},1457:function(t,e,n){n.d(e,{Wn:function(){return r.W},UI:function(){return j},O9:function(){return f},qS:function(){return Q},dE:function(){return o},S6:function(){return a},rU:function(){return u},je:function(){return D},j$:function(){return R},is:function(){return s},iL:function(){return V},NW:function(){return tt},bt:function(){return nt},tf:function(){return Y}});var r=n(1451),i=n(7294);const o=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),s={arr:Array.isArray,obj:t=>!!t&&"Object"===t.constructor.name,fun:t=>"function"===typeof t,str:t=>"string"===typeof t,num:t=>"number"===typeof t,und:t=>void 0===t};const a=(t,e)=>t.forEach(e);function u(t,e,n){if(s.arr(t))for(let r=0;r<t.length;r++)e.call(n,t[r],`${r}`);else for(const r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r)}const c=()=>"undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent);let l,h=null;new Set;const f={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},p="[-+]?\\d*\\.?\\d+",d=p+"%";function m(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}const g=new RegExp("rgb"+m(p,p,p)),v=new RegExp("rgba"+m(p,p,p,p)),y=new RegExp("hsl"+m(p,d,d)),w=new RegExp("hsla"+m(p,d,d,p)),b=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,x=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,I=/^#([0-9a-fA-F]{6})$/,M=/^#([0-9a-fA-F]{8})$/;function A(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function P(t,e,n){const r=n<.5?n*(1+e):n+e-n*e,i=2*n-r,o=A(i,r,t+1/3),s=A(i,r,t),a=A(i,r,t-1/3);return Math.round(255*o)<<24|Math.round(255*s)<<16|Math.round(255*a)<<8}function k(t){const e=parseInt(t,10);return e<0?0:e>255?255:e}function E(t){return(parseFloat(t)%360+360)%360/360}function T(t){const e=parseFloat(t);return e<0?0:e>1?255:Math.round(255*e)}function _(t){const e=parseFloat(t);return e<0?0:e>100?1:e/100}function S(t){let e=function(t){let e;return"number"===typeof t?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=I.exec(t))?parseInt(e[1]+"ff",16)>>>0:h&&void 0!==h[t]?h[t]:(e=g.exec(t))?(k(e[1])<<24|k(e[2])<<16|k(e[3])<<8|255)>>>0:(e=v.exec(t))?(k(e[1])<<24|k(e[2])<<16|k(e[3])<<8|T(e[4]))>>>0:(e=b.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=M.exec(t))?parseInt(e[1],16)>>>0:(e=x.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=y.exec(t))?(255|P(E(e[1]),_(e[2]),_(e[3])))>>>0:(e=w.exec(t))?(P(E(e[1]),_(e[2]),_(e[3]))|T(e[4]))>>>0:null}(t);return null===e?t:(e=e||0,`rgba(${(4278190080&e)>>>24}, ${(16711680&e)>>>16}, ${(65280&e)>>>8}, ${(255&e)/255})`)}const C=(t,e,n)=>{if(s.fun(t))return t;if(s.arr(t))return C({range:t,output:e,extrapolate:n});if(s.str(t.output[0]))return l(t);const r=t,i=r.output,o=r.range||[0,1],a=r.extrapolateLeft||r.extrapolate||"extend",u=r.extrapolateRight||r.extrapolate||"extend",c=r.easing||(t=>t);return t=>{const e=function(t,e){for(var n=1;n<e.length-1&&!(e[n]>=t);++n);return n-1}(t,o);return function(t,e,n,r,i,o,s,a,u){let c=u?u(t):t;if(c<e){if("identity"===s)return c;"clamp"===s&&(c=e)}if(c>n){if("identity"===a)return c;"clamp"===a&&(c=n)}if(r===i)return r;if(e===n)return t<=e?r:i;e===-1/0?c=-c:n===1/0?c-=e:c=(c-e)/(n-e);c=o(c),r===-1/0?c=-c:i===1/0?c+=r:c=c*(i-r)+r;return c}(t,o[e],o[e+1],i[e],i[e+1],c,a,u,r.map)}};function O(){return(O=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}const F=Symbol.for("FluidValue.get"),L=Symbol.for("FluidValue.observers"),R=t=>Boolean(t&&t[F]),D=t=>t&&t[F]?t[F]():t;function j(t,e){if(t[F]){let n=t[L];n||N(t,L,n=new Set),n.has(e)||(n.add(e),t.observerAdded&&t.observerAdded(n.size,e))}return e}function V(t,e){let n=t[L];if(n&&n.has(e)){const r=n.size-1;r?n.delete(e):t[L]=null,t.observerRemoved&&t.observerRemoved(r,e)}}const N=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),z=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,U=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,B=new RegExp(`(${z.source})(%|[a-z]+)`,"i"),W=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,G=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,q=t=>{const[e,n]=$(t);if(!e||c())return t;const r=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(r)return r.trim();if(n&&n.startsWith("--")){const e=window.getComputedStyle(document.documentElement).getPropertyValue(n);return e||t}return n&&G.test(n)?q(n):n||t},$=t=>{const e=G.exec(t);if(!e)return[,];const[,n,r]=e;return[n,r]};let X;const H=(t,e,n,r,i)=>`rgba(${Math.round(e)}, ${Math.round(n)}, ${Math.round(r)}, ${i})`,Q=t=>{X||(X=h?new RegExp(`(${Object.keys(h).join("|")})(?!\\w)`,"g"):/^\b$/);const e=t.output.map((t=>D(t).replace(G,q).replace(U,S).replace(X,S))),n=e.map((t=>t.match(z).map(Number))),r=n[0].map(((t,e)=>n.map((t=>{if(!(e in t))throw Error('The arity of each "output" value must be equal');return t[e]})))).map((e=>C(O({},t,{output:e}))));return t=>{var n;const i=!B.test(e[0])&&(null==(n=e.find((t=>B.test(t))))?void 0:n.replace(z,""));let o=0;return e[0].replace(z,(()=>`${r[o++](t)}${i||""}`)).replace(W,H)}},Z="react-spring: ",K=t=>{const e=t;let n=!1;if("function"!=typeof e)throw new TypeError(`${Z}once requires a function parameter`);return(...t)=>{n||(e(...t),n=!0)}};K(console.warn);K(console.warn);const Y=t=>(0,i.useEffect)(t,J),J=[];function tt(){const t=(0,i.useState)()[1],e=(0,i.useState)(et)[0];return Y(e.unmount),()=>{e.current&&t({})}}function et(){const t={current:!0,unmount:()=>()=>{t.current=!1}};return t}const nt="undefined"!==typeof window&&window.document&&window.document.createElement?i.useLayoutEffect:i.useEffect},1411:function(t,e,n){n.d(e,{y:function(){return Le}});var r={};n.r(r),n.d(r,{AsyncCompress:function(){return Ft},AsyncDecompress:function(){return Qt},AsyncDeflate:function(){return Pt},AsyncGunzip:function(){return jt},AsyncGzip:function(){return Ft},AsyncInflate:function(){return _t},AsyncUnzipInflate:function(){return Ie},AsyncUnzlib:function(){return qt},AsyncZipDeflate:function(){return ge},AsyncZlib:function(){return Ut},Compress:function(){return Ot},DecodeUTF8:function(){return re},Decompress:function(){return Ht},Deflate:function(){return At},EncodeUTF8:function(){return ie},Gunzip:function(){return Dt},Gzip:function(){return Ot},Inflate:function(){return Tt},Unzip:function(){return Me},UnzipInflate:function(){return xe},UnzipPassThrough:function(){return be},Unzlib:function(){return Gt},Zip:function(){return ve},ZipDeflate:function(){return me},ZipPassThrough:function(){return de},Zlib:function(){return zt},compress:function(){return Lt},compressSync:function(){return Rt},decompress:function(){return Zt},decompressSync:function(){return Kt},deflate:function(){return kt},deflateSync:function(){return Et},gunzip:function(){return Vt},gunzipSync:function(){return Nt},gzip:function(){return Lt},gzipSync:function(){return Rt},inflate:function(){return St},inflateSync:function(){return Ct},strFromU8:function(){return se},strToU8:function(){return oe},unzip:function(){return Ae},unzipSync:function(){return Pe},unzlib:function(){return $t},unzlibSync:function(){return Xt},zip:function(){return ye},zipSync:function(){return we},zlib:function(){return Bt},zlibSync:function(){return Wt}});var i=n(2212),o={},s=function(t){return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},a=function(t){return new Worker(t)};try{URL.revokeObjectURL(s(""))}catch(Je){s=function(t){return"data:application/javascript;charset=UTF-8,"+encodeURI(t)},a=function(t){return new Worker(t,{type:"module"})}}var u=Uint8Array,c=Uint16Array,l=Uint32Array,h=new u([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),f=new u([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),p=new u([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),d=function(t,e){for(var n=new c(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];var i=new l(n[30]);for(r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)i[o]=o-n[r]<<5|r;return[n,i]},m=d(h,2),g=m[0],v=m[1];g[28]=258,v[258]=28;for(var y=d(f,0),w=y[0],b=y[1],x=new c(32768),I=0;I<32768;++I){var M=(43690&I)>>>1|(21845&I)<<1;M=(61680&(M=(52428&M)>>>2|(13107&M)<<2))>>>4|(3855&M)<<4,x[I]=((65280&M)>>>8|(255&M)<<8)>>>1}var A=function(t,e,n){for(var r=t.length,i=0,o=new c(e);i<r;++i)++o[t[i]-1];var s,a=new c(e);for(i=0;i<e;++i)a[i]=a[i-1]+o[i-1]<<1;if(n){s=new c(1<<e);var u=15-e;for(i=0;i<r;++i)if(t[i])for(var l=i<<4|t[i],h=e-t[i],f=a[t[i]-1]++<<h,p=f|(1<<h)-1;f<=p;++f)s[x[f]>>>u]=l}else for(s=new c(r),i=0;i<r;++i)t[i]&&(s[i]=x[a[t[i]-1]++]>>>15-t[i]);return s},P=new u(288);for(I=0;I<144;++I)P[I]=8;for(I=144;I<256;++I)P[I]=9;for(I=256;I<280;++I)P[I]=7;for(I=280;I<288;++I)P[I]=8;var k=new u(32);for(I=0;I<32;++I)k[I]=5;var E=A(P,9,0),T=A(P,9,1),_=A(k,5,0),S=A(k,5,1),C=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},O=function(t,e,n){var r=e/8|0;return(t[r]|t[r+1]<<8)>>(7&e)&n},F=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(7&e)},L=function(t){return(t/8|0)+(7&t&&1)},R=function(t,e,n){(null==e||e<0)&&(e=0),(null==n||n>t.length)&&(n=t.length);var r=new(t instanceof c?c:t instanceof l?l:u)(n-e);return r.set(t.subarray(e,n)),r},D=function(t,e,n){var r=t.length;if(!r||n&&!n.l&&r<5)return e||new u(0);var i=!e||n,o=!n||n.i;n||(n={}),e||(e=new u(3*r));var s=function(t){var n=e.length;if(t>n){var r=new u(Math.max(2*n,t));r.set(e),e=r}},a=n.f||0,c=n.p||0,l=n.b||0,d=n.l,m=n.d,v=n.m,y=n.n,b=8*r;do{if(!d){n.f=a=O(t,c,1);var x=O(t,c+1,3);if(c+=3,!x){var I=t[(U=L(c)+4)-4]|t[U-3]<<8,M=U+I;if(M>r){if(o)throw"unexpected EOF";break}i&&s(l+I),e.set(t.subarray(U,M),l),n.b=l+=I,n.p=c=8*M;continue}if(1==x)d=T,m=S,v=9,y=5;else{if(2!=x)throw"invalid block type";var P=O(t,c,31)+257,k=O(t,c+10,15)+4,E=P+O(t,c+5,31)+1;c+=14;for(var _=new u(E),D=new u(19),j=0;j<k;++j)D[p[j]]=O(t,c+3*j,7);c+=3*k;var V=C(D),N=(1<<V)-1,z=A(D,V,1);for(j=0;j<E;){var U,B=z[O(t,c,N)];if(c+=15&B,(U=B>>>4)<16)_[j++]=U;else{var W=0,G=0;for(16==U?(G=3+O(t,c,3),c+=2,W=_[j-1]):17==U?(G=3+O(t,c,7),c+=3):18==U&&(G=11+O(t,c,127),c+=7);G--;)_[j++]=W}}var q=_.subarray(0,P),$=_.subarray(P);v=C(q),y=C($),d=A(q,v,1),m=A($,y,1)}if(c>b){if(o)throw"unexpected EOF";break}}i&&s(l+131072);for(var X=(1<<v)-1,H=(1<<y)-1,Q=c;;Q=c){var Z=(W=d[F(t,c)&X])>>>4;if((c+=15&W)>b){if(o)throw"unexpected EOF";break}if(!W)throw"invalid length/literal";if(Z<256)e[l++]=Z;else{if(256==Z){Q=c,d=null;break}var K=Z-254;if(Z>264){var Y=h[j=Z-257];K=O(t,c,(1<<Y)-1)+g[j],c+=Y}var J=m[F(t,c)&H],tt=J>>>4;if(!J)throw"invalid distance";c+=15&J;$=w[tt];if(tt>3){Y=f[tt];$+=F(t,c)&(1<<Y)-1,c+=Y}if(c>b){if(o)throw"unexpected EOF";break}i&&s(l+131072);for(var et=l+K;l<et;l+=4)e[l]=e[l-$],e[l+1]=e[l+1-$],e[l+2]=e[l+2-$],e[l+3]=e[l+3-$];l=et}}n.l=d,n.p=Q,n.b=l,d&&(a=1,n.m=v,n.d=m,n.n=y)}while(!a);return l==e.length?e:R(e,0,l)},j=function(t,e,n){n<<=7&e;var r=e/8|0;t[r]|=n,t[r+1]|=n>>>8},V=function(t,e,n){n<<=7&e;var r=e/8|0;t[r]|=n,t[r+1]|=n>>>8,t[r+2]|=n>>>16},N=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var i=n.length,o=n.slice();if(!i)return[$,0];if(1==i){var s=new u(n[0].s+1);return s[n[0].s]=1,[s,1]}n.sort((function(t,e){return t.f-e.f})),n.push({s:-1,f:25001});var a=n[0],l=n[1],h=0,f=1,p=2;for(n[0]={s:-1,f:a.f+l.f,l:a,r:l};f!=i-1;)a=n[n[h].f<n[p].f?h++:p++],l=n[h!=f&&n[h].f<n[p].f?h++:p++],n[f++]={s:-1,f:a.f+l.f,l:a,r:l};var d=o[0].s;for(r=1;r<i;++r)o[r].s>d&&(d=o[r].s);var m=new c(d+1),g=z(n[f-1],m,0);if(g>e){r=0;var v=0,y=g-e,w=1<<y;for(o.sort((function(t,e){return m[e.s]-m[t.s]||t.f-e.f}));r<i;++r){var b=o[r].s;if(!(m[b]>e))break;v+=w-(1<<g-m[b]),m[b]=e}for(v>>>=y;v>0;){var x=o[r].s;m[x]<e?v-=1<<e-m[x]++-1:++r}for(;r>=0&&v;--r){var I=o[r].s;m[I]==e&&(--m[I],++v)}g=e}return[new u(m),g]},z=function(t,e,n){return-1==t.s?Math.max(z(t.l,e,n+1),z(t.r,e,n+1)):e[t.s]=n},U=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new c(++e),r=0,i=t[0],o=1,s=function(t){n[r++]=t},a=1;a<=e;++a)if(t[a]==i&&a!=e)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=t[a]}return[n.subarray(0,r),e]},B=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},W=function(t,e,n){var r=n.length,i=L(e+2);t[i]=255&r,t[i+1]=r>>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var o=0;o<r;++o)t[i+o+4]=n[o];return 8*(i+4+r)},G=function(t,e,n,r,i,o,s,a,u,l,d){j(e,d++,n),++i[256];for(var m=N(i,15),g=m[0],v=m[1],y=N(o,15),w=y[0],b=y[1],x=U(g),I=x[0],M=x[1],T=U(w),S=T[0],C=T[1],O=new c(19),F=0;F<I.length;++F)O[31&I[F]]++;for(F=0;F<S.length;++F)O[31&S[F]]++;for(var L=N(O,7),R=L[0],D=L[1],z=19;z>4&&!R[p[z-1]];--z);var G,q,$,X,H=l+5<<3,Q=B(i,P)+B(o,k)+s,Z=B(i,g)+B(o,w)+s+14+3*z+B(O,R)+(2*O[16]+3*O[17]+7*O[18]);if(H<=Q&&H<=Z)return W(e,d,t.subarray(u,u+l));if(j(e,d,1+(Z<Q)),d+=2,Z<Q){G=A(g,v,0),q=g,$=A(w,b,0),X=w;var K=A(R,D,0);j(e,d,M-257),j(e,d+5,C-1),j(e,d+10,z-4),d+=14;for(F=0;F<z;++F)j(e,d+3*F,R[p[F]]);d+=3*z;for(var Y=[I,S],J=0;J<2;++J){var tt=Y[J];for(F=0;F<tt.length;++F){var et=31&tt[F];j(e,d,K[et]),d+=R[et],et>15&&(j(e,d,tt[F]>>>5&127),d+=tt[F]>>>12)}}}else G=E,q=P,$=_,X=k;for(F=0;F<a;++F)if(r[F]>255){et=r[F]>>>18&31;V(e,d,G[et+257]),d+=q[et+257],et>7&&(j(e,d,r[F]>>>23&31),d+=h[et]);var nt=31&r[F];V(e,d,$[nt]),d+=X[nt],nt>3&&(V(e,d,r[F]>>>5&8191),d+=f[nt])}else V(e,d,G[r[F]]),d+=q[r[F]];return V(e,d,G[256]),d+q[256]},q=new l([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),$=new u(0),X=function(t,e,n,r,i,o){var s=t.length,a=new u(r+s+5*(1+Math.ceil(s/7e3))+i),p=a.subarray(r,a.length-i),d=0;if(!e||s<8)for(var m=0;m<=s;m+=65535){var g=m+65535;g<s?d=W(p,d,t.subarray(m,g)):(p[m]=o,d=W(p,d,t.subarray(m,s)))}else{for(var y=q[e-1],w=y>>>13,x=8191&y,I=(1<<n)-1,M=new c(32768),A=new c(I+1),P=Math.ceil(n/3),k=2*P,E=function(e){return(t[e]^t[e+1]<<P^t[e+2]<<k)&I},T=new l(25e3),_=new c(288),S=new c(32),C=0,O=0,F=(m=0,0),D=0,j=0;m<s;++m){var V=E(m),N=32767&m,z=A[V];if(M[N]=z,A[V]=N,D<=m){var U=s-m;if((C>7e3||F>24576)&&U>423){d=G(t,p,0,T,_,S,O,F,j,m-j,d),F=C=O=0,j=m;for(var B=0;B<286;++B)_[B]=0;for(B=0;B<30;++B)S[B]=0}var X=2,H=0,Q=x,Z=N-z&32767;if(U>2&&V==E(m-Z))for(var K=Math.min(w,U)-1,Y=Math.min(32767,m),J=Math.min(258,U);Z<=Y&&--Q&&N!=z;){if(t[m+X]==t[m+X-Z]){for(var tt=0;tt<J&&t[m+tt]==t[m+tt-Z];++tt);if(tt>X){if(X=tt,H=Z,tt>K)break;var et=Math.min(Z,tt-2),nt=0;for(B=0;B<et;++B){var rt=m-Z+B+32768&32767,it=rt-M[rt]+32768&32767;it>nt&&(nt=it,z=rt)}}}Z+=(N=z)-(z=M[N])+32768&32767}if(H){T[F++]=268435456|v[X]<<18|b[H];var ot=31&v[X],st=31&b[H];O+=h[ot]+f[st],++_[257+ot],++S[st],D=m+X,++C}else T[F++]=t[m],++_[t[m]]}}d=G(t,p,o,T,_,S,O,F,j,m-j,d),!o&&7&d&&(d=W(p,d+1,$))}return R(a,0,r+L(d)+i)},H=function(){for(var t=new l(256),e=0;e<256;++e){for(var n=e,r=9;--r;)n=(1&n&&3988292384)^n>>>1;t[e]=n}return t}(),Q=function(){var t=-1;return{p:function(e){for(var n=t,r=0;r<e.length;++r)n=H[255&n^e[r]]^n>>>8;t=n},d:function(){return~t}}},Z=function(){var t=1,e=0;return{p:function(n){for(var r=t,i=e,o=n.length,s=0;s!=o;){for(var a=Math.min(s+2655,o);s<a;++s)i+=r+=n[s];r=(65535&r)+15*(r>>16),i=(65535&i)+15*(i>>16)}t=r,e=i},d:function(){return(255&(t%=65521))<<24|t>>>8<<16|(255&(e%=65521))<<8|e>>>8}}},K=function(t,e,n,r,i){return X(t,null==e.level?6:e.level,null==e.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,n,r,!i)},Y=function(t,e){var n={};for(var r in t)n[r]=t[r];for(var r in e)n[r]=e[r];return n},J=function(t,e,n){for(var r=t(),i=t.toString(),o=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/ /g,"").split(","),s=0;s<r.length;++s){var a=r[s],u=o[s];if("function"==typeof a){e+=";"+u+"=";var c=a.toString();if(a.prototype)if(-1!=c.indexOf("[native code]")){var l=c.indexOf(" ",8)+1;e+=c.slice(l,c.indexOf("(",l))}else for(var h in e+=c,a.prototype)e+=";"+u+".prototype."+h+"="+a.prototype[h].toString();else e+=c}else n[u]=a}return[e,n]},tt=[],et=function(t,e,n,r){var i;if(!tt[n]){for(var h="",f={},p=t.length-1,d=0;d<p;++d)h=(i=J(t[d],h,f))[0],f=i[1];tt[n]=J(t[p],h,f)}var m=Y({},tt[n][1]);return function(t,e,n,r,i){var u=a(o[e]||(o[e]=s(t)));return u.onerror=function(t){return i(t.error,null)},u.onmessage=function(t){return i(null,t.data)},u.postMessage(n,r),u}(tt[n][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",n,m,function(t){var e=[];for(var n in t)(t[n]instanceof u||t[n]instanceof c||t[n]instanceof l)&&e.push((t[n]=new t[n].constructor(t[n])).buffer);return e}(m),r)},nt=function(){return[u,c,l,h,f,p,g,w,T,S,x,A,C,O,F,L,R,D,Ct,ut,ct]},rt=function(){return[u,c,l,h,f,p,v,b,E,P,_,k,x,q,$,A,j,V,N,z,U,B,W,G,L,R,X,K,Et,ut]},it=function(){return[vt,bt,gt,Q,H]},ot=function(){return[yt,wt]},st=function(){return[xt,gt,Z]},at=function(){return[It]},ut=function(t){return postMessage(t,[t.buffer])},ct=function(t){return t&&t.size&&new u(t.size)},lt=function(t,e,n,r,i,o){var s=et(n,r,i,(function(t,e){s.terminate(),o(t,e)}));return s.postMessage([t,e],e.consume?[t.buffer]:[]),function(){s.terminate()}},ht=function(t){return t.ondata=function(t,e){return postMessage([t,e],[t.buffer])},function(e){return t.push(e.data[0],e.data[1])}},ft=function(t,e,n,r,i){var o,s=et(t,r,i,(function(t,n){t?(s.terminate(),e.ondata.call(e,t)):(n[1]&&s.terminate(),e.ondata.call(e,t,n[0],n[1]))}));s.postMessage(n),e.push=function(t,n){if(o)throw"stream finished";if(!e.ondata)throw"no stream handler";s.postMessage([t,o=n],[t.buffer])},e.terminate=function(){s.terminate()}},pt=function(t,e){return t[e]|t[e+1]<<8},dt=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},mt=function(t,e){return dt(t,e)+4294967296*dt(t,e+4)},gt=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},vt=function(t,e){var n=e.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=e.level<2?4:9==e.level?2:0,t[9]=3,0!=e.mtime&&gt(t,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),n){t[3]=8;for(var r=0;r<=n.length;++r)t[r+10]=n.charCodeAt(r)}},yt=function(t){if(31!=t[0]||139!=t[1]||8!=t[2])throw"invalid gzip data";var e=t[3],n=10;4&e&&(n+=t[10]|2+(t[11]<<8));for(var r=(e>>3&1)+(e>>4&1);r>0;r-=!t[n++]);return n+(2&e)},wt=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},bt=function(t){return 10+(t.filename&&t.filename.length+1||0)},xt=function(t,e){var n=e.level,r=0==n?0:n<6?1:9==n?3:2;t[0]=120,t[1]=r<<6|(r?32-2*r:1)},It=function(t){if(8!=(15&t[0])||t[0]>>>4>7||(t[0]<<8|t[1])%31)throw"invalid zlib data";if(32&t[1])throw"invalid zlib data: preset dictionaries not supported"};function Mt(t,e){return e||"function"!=typeof t||(e=t,t={}),this.ondata=e,t}var At=function(){function t(t,e){e||"function"!=typeof t||(e=t,t={}),this.ondata=e,this.o=t||{}}return t.prototype.p=function(t,e){this.ondata(K(t,this.o,0,0,!e),e)},t.prototype.push=function(t,e){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=e,this.p(t,e||!1)},t}(),Pt=function(){return function(t,e){ft([rt,function(){return[ht,At]}],this,Mt.call(this,t,e),(function(t){var e=new At(t.data);onmessage=ht(e)}),6)}}();function kt(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return lt(t,e,[rt],(function(t){return ut(Et(t.data[0],t.data[1]))}),0,n)}function Et(t,e){return K(t,e||{},0,0)}var Tt=function(){function t(t){this.s={},this.p=new u(0),this.ondata=t}return t.prototype.e=function(t){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var e=this.p.length,n=new u(e+t.length);n.set(this.p),n.set(t,e),this.p=n},t.prototype.c=function(t){this.d=this.s.i=t||!1;var e=this.s.b,n=D(this.p,this.o,this.s);this.ondata(R(n,e,this.s.b),this.d),this.o=R(n,this.s.b-32768),this.s.b=this.o.length,this.p=R(this.p,this.s.p/8|0),this.s.p&=7},t.prototype.push=function(t,e){this.e(t),this.c(e)},t}(),_t=function(){return function(t){this.ondata=t,ft([nt,function(){return[ht,Tt]}],this,0,(function(){var t=new Tt;onmessage=ht(t)}),7)}}();function St(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return lt(t,e,[nt],(function(t){return ut(Ct(t.data[0],ct(t.data[1])))}),1,n)}function Ct(t,e){return D(t,e)}var Ot=function(){function t(t,e){this.c=Q(),this.l=0,this.v=1,At.call(this,t,e)}return t.prototype.push=function(t,e){At.prototype.push.call(this,t,e)},t.prototype.p=function(t,e){this.c.p(t),this.l+=t.length;var n=K(t,this.o,this.v&&bt(this.o),e&&8,!e);this.v&&(vt(n,this.o),this.v=0),e&&(gt(n,n.length-8,this.c.d()),gt(n,n.length-4,this.l)),this.ondata(n,e)},t}(),Ft=function(){return function(t,e){ft([rt,it,function(){return[ht,At,Ot]}],this,Mt.call(this,t,e),(function(t){var e=new Ot(t.data);onmessage=ht(e)}),8)}}();function Lt(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return lt(t,e,[rt,it,function(){return[Rt]}],(function(t){return ut(Rt(t.data[0],t.data[1]))}),2,n)}function Rt(t,e){e||(e={});var n=Q(),r=t.length;n.p(t);var i=K(t,e,bt(e),8),o=i.length;return vt(i,e),gt(i,o-8,n.d()),gt(i,o-4,r),i}var Dt=function(){function t(t){this.v=1,Tt.call(this,t)}return t.prototype.push=function(t,e){if(Tt.prototype.e.call(this,t),this.v){var n=this.p.length>3?yt(this.p):4;if(n>=this.p.length&&!e)return;this.p=this.p.subarray(n),this.v=0}if(e){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}Tt.prototype.c.call(this,e)},t}(),jt=function(){return function(t){this.ondata=t,ft([nt,ot,function(){return[ht,Tt,Dt]}],this,0,(function(){var t=new Dt;onmessage=ht(t)}),9)}}();function Vt(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return lt(t,e,[nt,ot,function(){return[Nt]}],(function(t){return ut(Nt(t.data[0]))}),3,n)}function Nt(t,e){return D(t.subarray(yt(t),-8),e||new u(wt(t)))}var zt=function(){function t(t,e){this.c=Z(),this.v=1,At.call(this,t,e)}return t.prototype.push=function(t,e){At.prototype.push.call(this,t,e)},t.prototype.p=function(t,e){this.c.p(t);var n=K(t,this.o,this.v&&2,e&&4,!e);this.v&&(xt(n,this.o),this.v=0),e&&gt(n,n.length-4,this.c.d()),this.ondata(n,e)},t}(),Ut=function(){return function(t,e){ft([rt,st,function(){return[ht,At,zt]}],this,Mt.call(this,t,e),(function(t){var e=new zt(t.data);onmessage=ht(e)}),10)}}();function Bt(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return lt(t,e,[rt,st,function(){return[Wt]}],(function(t){return ut(Wt(t.data[0],t.data[1]))}),4,n)}function Wt(t,e){e||(e={});var n=Z();n.p(t);var r=K(t,e,2,4);return xt(r,e),gt(r,r.length-4,n.d()),r}var Gt=function(){function t(t){this.v=1,Tt.call(this,t)}return t.prototype.push=function(t,e){if(Tt.prototype.e.call(this,t),this.v){if(this.p.length<2&&!e)return;this.p=this.p.subarray(2),this.v=0}if(e){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}Tt.prototype.c.call(this,e)},t}(),qt=function(){return function(t){this.ondata=t,ft([nt,at,function(){return[ht,Tt,Gt]}],this,0,(function(){var t=new Gt;onmessage=ht(t)}),11)}}();function $t(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return lt(t,e,[nt,at,function(){return[Xt]}],(function(t){return ut(Xt(t.data[0],ct(t.data[1])))}),5,n)}function Xt(t,e){return D((It(t),t.subarray(2,-4)),e)}var Ht=function(){function t(t){this.G=Dt,this.I=Tt,this.Z=Gt,this.ondata=t}return t.prototype.push=function(t,e){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(t,e);else{if(this.p&&this.p.length){var n=new u(this.p.length+t.length);n.set(this.p),n.set(t,this.p.length)}else this.p=t;if(this.p.length>2){var r=this,i=function(){r.ondata.apply(r,arguments)};this.s=31==this.p[0]&&139==this.p[1]&&8==this.p[2]?new this.G(i):8!=(15&this.p[0])||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(i):new this.Z(i),this.s.push(this.p,e),this.p=null}}},t}(),Qt=function(){function t(t){this.G=jt,this.I=_t,this.Z=qt,this.ondata=t}return t.prototype.push=function(t,e){Ht.prototype.push.call(this,t,e)},t}();function Zt(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return 31==t[0]&&139==t[1]&&8==t[2]?Vt(t,e,n):8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31?St(t,e,n):$t(t,e,n)}function Kt(t,e){return 31==t[0]&&139==t[1]&&8==t[2]?Nt(t,e):8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31?Ct(t,e):Xt(t,e)}var Yt=function(t,e,n,r){for(var i in t){var o=t[i],s=e+i;o instanceof u?n[s]=[o,r]:Array.isArray(o)?n[s]=[o[0],Y(r,o[1])]:Yt(o,s+"/",n,r)}},Jt="undefined"!=typeof TextEncoder&&new TextEncoder,te="undefined"!=typeof TextDecoder&&new TextDecoder,ee=0;try{te.decode($,{stream:!0}),ee=1}catch(Je){}var ne=function(t){for(var e="",n=0;;){var r=t[n++],i=(r>127)+(r>223)+(r>239);if(n+i>t.length)return[e,R(t,n-1)];i?3==i?(r=((15&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536,e+=String.fromCharCode(55296|r>>10,56320|1023&r)):e+=1&i?String.fromCharCode((31&r)<<6|63&t[n++]):String.fromCharCode((15&r)<<12|(63&t[n++])<<6|63&t[n++]):e+=String.fromCharCode(r)}},re=function(){function t(t){this.ondata=t,ee?this.t=new TextDecoder:this.p=$}return t.prototype.push=function(t,e){if(!this.ondata)throw"no callback";if(e=!!e,this.t){if(this.ondata(this.t.decode(t,{stream:!0}),e),e){if(this.t.decode().length)throw"invalid utf-8 data";this.t=null}}else{if(!this.p)throw"stream finished";var n=new u(this.p.length+t.length);n.set(this.p),n.set(t,this.p.length);var r=ne(n),i=r[0],o=r[1];if(e){if(o.length)throw"invalid utf-8 data";this.p=null}else this.p=o;this.ondata(i,e)}},t}(),ie=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,e){if(!this.ondata)throw"no callback";if(this.d)throw"stream finished";this.ondata(oe(t),this.d=e||!1)},t}();function oe(t,e){if(e){for(var n=new u(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n}if(Jt)return Jt.encode(t);var i=t.length,o=new u(t.length+(t.length>>1)),s=0,a=function(t){o[s++]=t};for(r=0;r<i;++r){if(s+5>o.length){var c=new u(s+8+(i-r<<1));c.set(o),o=c}var l=t.charCodeAt(r);l<128||e?a(l):l<2048?(a(192|l>>6),a(128|63&l)):l>55295&&l<57344?(a(240|(l=65536+(1047552&l)|1023&t.charCodeAt(++r))>>18),a(128|l>>12&63),a(128|l>>6&63),a(128|63&l)):(a(224|l>>12),a(128|l>>6&63),a(128|63&l))}return R(o,0,s)}function se(t,e){if(e){for(var n="",r=0;r<t.length;r+=16384)n+=String.fromCharCode.apply(null,t.subarray(r,r+16384));return n}if(te)return te.decode(t);var i=ne(t),o=i[0];if(i[1].length)throw"invalid utf-8 data";return o}var ae=function(t){return 1==t?3:t<6?2:9==t?1:0},ue=function(t,e){return e+30+pt(t,e+26)+pt(t,e+28)},ce=function(t,e,n){var r=pt(t,e+28),i=se(t.subarray(e+46,e+46+r),!(2048&pt(t,e+8))),o=e+46+r,s=dt(t,e+20),a=n&&4294967295==s?le(t,o):[s,dt(t,e+24),dt(t,e+42)],u=a[0],c=a[1],l=a[2];return[pt(t,e+10),u,c,i,o+pt(t,e+30)+pt(t,e+32),l]},le=function(t,e){for(;1!=pt(t,e);e+=4+pt(t,e+2));return[mt(t,e+12),mt(t,e+4),mt(t,e+20)]},he=function(t){var e=0;if(t)for(var n in t){var r=t[n].length;if(r>65535)throw"extra field too long";e+=r+4}return e},fe=function(t,e,n,r,i,o,s,a){var u=r.length,c=n.extra,l=a&&a.length,h=he(c);gt(t,e,null!=s?33639248:67324752),e+=4,null!=s&&(t[e++]=20,t[e++]=n.os),t[e]=20,e+=2,t[e++]=n.flag<<1|(null==o&&8),t[e++]=i&&8,t[e++]=255&n.compression,t[e++]=n.compression>>8;var f=new Date(null==n.mtime?Date.now():n.mtime),p=f.getFullYear()-1980;if(p<0||p>119)throw"date not in range 1980-2099";if(gt(t,e,p<<25|f.getMonth()+1<<21|f.getDate()<<16|f.getHours()<<11|f.getMinutes()<<5|f.getSeconds()>>>1),e+=4,null!=o&&(gt(t,e,n.crc),gt(t,e+4,o),gt(t,e+8,n.size)),gt(t,e+12,u),gt(t,e+14,h),e+=16,null!=s&&(gt(t,e,l),gt(t,e+6,n.attrs),gt(t,e+10,s),e+=14),t.set(r,e),e+=u,h)for(var d in c){var m=c[d],g=m.length;gt(t,e,+d),gt(t,e+2,g),t.set(m,e+4),e+=4+g}return l&&(t.set(a,e),e+=l),e},pe=function(t,e,n,r,i){gt(t,e,101010256),gt(t,e+8,n),gt(t,e+10,n),gt(t,e+12,r),gt(t,e+16,i)},de=function(){function t(t){this.filename=t,this.c=Q(),this.size=0,this.compression=0}return t.prototype.process=function(t,e){this.ondata(null,t,e)},t.prototype.push=function(t,e){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(t),this.size+=t.length,e&&(this.crc=this.c.d()),this.process(t,e||!1)},t}(),me=function(){function t(t,e){var n=this;e||(e={}),de.call(this,t),this.d=new At(e,(function(t,e){n.ondata(null,t,e)})),this.compression=8,this.flag=ae(e.level)}return t.prototype.process=function(t,e){try{this.d.push(t,e)}catch(Je){this.ondata(Je,null,e)}},t.prototype.push=function(t,e){de.prototype.push.call(this,t,e)},t}(),ge=function(){function t(t,e){var n=this;e||(e={}),de.call(this,t),this.d=new Pt(e,(function(t,e,r){n.ondata(t,e,r)})),this.compression=8,this.flag=ae(e.level),this.terminate=this.d.terminate}return t.prototype.process=function(t,e){this.d.push(t,e)},t.prototype.push=function(t,e){de.prototype.push.call(this,t,e)},t}(),ve=function(){function t(t){this.ondata=t,this.u=[],this.d=1}return t.prototype.add=function(t){var e=this;if(2&this.d)throw"stream finished";var n=oe(t.filename),r=n.length,i=t.comment,o=i&&oe(i),s=r!=t.filename.length||o&&i.length!=o.length,a=r+he(t.extra)+30;if(r>65535)throw"filename too long";var c=new u(a);fe(c,0,t,n,s);var l=[c],h=function(){for(var t=0,n=l;t<n.length;t++){var r=n[t];e.ondata(null,r,!1)}l=[]},f=this.d;this.d=0;var p=this.u.length,d=Y(t,{f:n,u:s,o:o,t:function(){t.terminate&&t.terminate()},r:function(){if(h(),f){var t=e.u[p+1];t?t.r():e.d=1}f=1}}),m=0;t.ondata=function(n,r,i){if(n)e.ondata(n,r,i),e.terminate();else if(m+=r.length,l.push(r),i){var o=new u(16);gt(o,0,134695760),gt(o,4,t.crc),gt(o,8,m),gt(o,12,t.size),l.push(o),d.c=m,d.b=a+m+16,d.crc=t.crc,d.size=t.size,f&&d.r(),f=1}else f&&h()},this.u.push(d)},t.prototype.end=function(){var t=this;if(2&this.d){if(1&this.d)throw"stream finishing";throw"stream finished"}this.d?this.e():this.u.push({r:function(){1&t.d&&(t.u.splice(-1,1),t.e())},t:function(){}}),this.d=3},t.prototype.e=function(){for(var t=0,e=0,n=0,r=0,i=this.u;r<i.length;r++){n+=46+(c=i[r]).f.length+he(c.extra)+(c.o?c.o.length:0)}for(var o=new u(n+22),s=0,a=this.u;s<a.length;s++){var c=a[s];fe(o,t,c,c.f,c.u,c.c,e,c.o),t+=46+c.f.length+he(c.extra)+(c.o?c.o.length:0),e+=c.b}pe(o,t,this.u.length,n,e),this.ondata(null,o,!0),this.d=2},t.prototype.terminate=function(){for(var t=0,e=this.u;t<e.length;t++){e[t].t()}this.d=2},t}();function ye(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";var r={};Yt(t,"",r,e);var i=Object.keys(r),o=i.length,s=0,a=0,c=o,l=new Array(o),h=[],f=function(){for(var t=0;t<h.length;++t)h[t]()},p=function(){var t=new u(a+22),e=s,r=a-s;a=0;for(var i=0;i<c;++i){var o=l[i];try{var h=o.c.length;fe(t,a,o,o.f,o.u,h);var f=30+o.f.length+he(o.extra),p=a+f;t.set(o.c,p),fe(t,s,o,o.f,o.u,h,a,o.m),s+=16+f+(o.m?o.m.length:0),a=p+h}catch(Je){return n(Je,null)}}pe(t,s,l.length,r,e),n(null,t)};o||p();for(var d=function(t){var e=i[t],u=r[e],c=u[0],d=u[1],m=Q(),g=c.length;m.p(c);var v=oe(e),y=v.length,w=d.comment,b=w&&oe(w),x=b&&b.length,I=he(d.extra),M=0==d.level?0:8,A=function(r,i){if(r)f(),n(r,null);else{var u=i.length;l[t]=Y(d,{size:g,crc:m.d(),c:i,f:v,m:b,u:y!=e.length||b&&w.length!=x,compression:M}),s+=30+y+I+u,a+=76+2*(y+I)+(x||0)+u,--o||p()}};if(y>65535&&A("filename too long",null),M)if(g<16e4)try{A(null,Et(c,d))}catch(Je){A(Je,null)}else h.push(kt(c,d,A));else A(null,c)},m=0;m<c;++m)d(m);return f}function we(t,e){e||(e={});var n={},r=[];Yt(t,"",n,e);var i=0,o=0;for(var s in n){var a=n[s],c=a[0],l=a[1],h=0==l.level?0:8,f=(A=oe(s)).length,p=l.comment,d=p&&oe(p),m=d&&d.length,g=he(l.extra);if(f>65535)throw"filename too long";var v=h?Et(c,l):c,y=v.length,w=Q();w.p(c),r.push(Y(l,{size:c.length,crc:w.d(),c:v,f:A,m:d,u:f!=s.length||d&&p.length!=m,o:i,compression:h})),i+=30+f+g+y,o+=76+2*(f+g)+(m||0)+y}for(var b=new u(o+22),x=i,I=o-i,M=0;M<r.length;++M){var A=r[M];fe(b,A.o,A,A.f,A.u,A.c.length);var P=30+A.f.length+he(A.extra);b.set(A.c,A.o+P),fe(b,i,A,A.f,A.u,A.c.length,A.o,A.m),i+=16+P+(A.m?A.m.length:0)}return pe(b,i,r.length,I,x),b}var be=function(){function t(){}return t.prototype.push=function(t,e){this.ondata(null,t,e)},t.compression=0,t}(),xe=function(){function t(){var t=this;this.i=new Tt((function(e,n){t.ondata(null,e,n)}))}return t.prototype.push=function(t,e){try{this.i.push(t,e)}catch(Je){this.ondata(Je,t,e)}},t.compression=8,t}(),Ie=function(){function t(t,e){var n=this;e<32e4?this.i=new Tt((function(t,e){n.ondata(null,t,e)})):(this.i=new _t((function(t,e,r){n.ondata(t,e,r)})),this.terminate=this.i.terminate)}return t.prototype.push=function(t,e){this.i.terminate&&(t=R(t,0)),this.i.push(t,e)},t.compression=8,t}(),Me=function(){function t(t){this.onfile=t,this.k=[],this.o={0:be},this.p=$}return t.prototype.push=function(t,e){var n=this;if(!this.onfile)throw"no callback";if(!this.p)throw"stream finished";if(this.c>0){var r=Math.min(this.c,t.length),i=t.subarray(0,r);if(this.c-=r,this.d?this.d.push(i,!this.c):this.k[0].push(i),(t=t.subarray(r)).length)return this.push(t,e)}else{var o=0,s=0,a=void 0,c=void 0;this.p.length?t.length?((c=new u(this.p.length+t.length)).set(this.p),c.set(t,this.p.length)):c=this.p:c=t;for(var l=c.length,h=this.c,f=h&&this.d,p=function(){var t,e=dt(c,s);if(67324752==e){o=1,a=s,d.d=null,d.c=0;var r=pt(c,s+6),i=pt(c,s+8),u=2048&r,f=8&r,p=pt(c,s+26),m=pt(c,s+28);if(l>s+30+p+m){var g=[];d.k.unshift(g),o=2;var v,y=dt(c,s+18),w=dt(c,s+22),b=se(c.subarray(s+30,s+=30+p),!u);4294967295==y?(t=f?[-2]:le(c,s),y=t[0],w=t[1]):f&&(y=-1),s+=m,d.c=y;var x={name:b,compression:i,start:function(){if(!x.ondata)throw"no callback";if(y){var t=n.o[i];if(!t)throw"unknown compression type "+i;(v=y<0?new t(b):new t(b,y,w)).ondata=function(t,e,n){x.ondata(t,e,n)};for(var e=0,r=g;e<r.length;e++){var o=r[e];v.push(o,!1)}n.k[0]==g&&n.c?n.d=v:v.push($,!0)}else x.ondata(null,$,!0)},terminate:function(){v&&v.terminate&&v.terminate()}};y>=0&&(x.size=y,x.originalSize=w),d.onfile(x)}return"break"}if(h){if(134695760==e)return a=s+=12+(-2==h&&8),o=3,d.c=0,"break";if(33639248==e)return a=s-=4,o=3,d.c=0,"break"}},d=this;s<l-4;++s){if("break"===p())break}if(this.p=$,h<0){var m=o?c.subarray(0,a-12-(-2==h&&8)-(134695760==dt(c,a-16)&&4)):c.subarray(0,s);f?f.push(m,!!o):this.k[+(2==o)].push(m)}if(2&o)return this.push(c.subarray(s),e);this.p=c.subarray(s)}if(e){if(this.c)throw"invalid zip file";this.p=null}},t.prototype.register=function(t){this.o[t.compression]=t},t}();function Ae(t,e){if("function"!=typeof e)throw"no callback";for(var n=[],r=function(){for(var t=0;t<n.length;++t)n[t]()},i={},o=t.length-22;101010256!=dt(t,o);--o)if(!o||t.length-o>65558)return void e("invalid zip file",null);var s=pt(t,o+8);s||e(null,{});var a=s,c=dt(t,o+16),l=4294967295==c;if(l){if(o=dt(t,o-12),101075792!=dt(t,o))return void e("invalid zip file",null);a=s=dt(t,o+32),c=dt(t,o+48)}for(var h=function(a){var h=ce(t,c,l),f=h[0],p=h[1],d=h[2],m=h[3],g=h[4],v=h[5],y=ue(t,v);c=g;var w=function(t,n){t?(r(),e(t,null)):(i[m]=n,--s||e(null,i))};if(f)if(8==f){var b=t.subarray(y,y+p);if(p<32e4)try{w(null,Ct(b,new u(d)))}catch(o){w(o,null)}else n.push(St(b,{size:d},w))}else w("unknown compression type "+f,null);else w(null,R(t,y,y+p))},f=0;f<a;++f)h();return r}function Pe(t){for(var e={},n=t.length-22;101010256!=dt(t,n);--n)if(!n||t.length-n>65558)throw"invalid zip file";var r=pt(t,n+8);if(!r)return{};var i=dt(t,n+16),o=4294967295==i;if(o){if(n=dt(t,n-12),101075792!=dt(t,n))throw"invalid zip file";r=dt(t,n+32),i=dt(t,n+48)}for(var s=0;s<r;++s){var a=ce(t,i,o),c=a[0],l=a[1],h=a[2],f=a[3],p=a[4],d=a[5],m=ue(t,d);if(i=p,c){if(8!=c)throw"unknown compression type "+c;e[f]=Ct(t.subarray(m,m+l),new u(h))}else e[f]=R(t,m,m+l)}return e}function ke(t,e,n){const r=n.length-t-1;if(e>=n[r])return r-1;if(e<=n[t])return t;let i=t,o=r,s=Math.floor((i+o)/2);for(;e<n[s]||e>=n[s+1];)e<n[s]?o=s:i=s,s=Math.floor((i+o)/2);return s}function Ee(t,e,n,r){const i=[],o=[],s=[];i[0]=1;for(let a=1;a<=n;++a){o[a]=e-r[t+1-a],s[a]=r[t+a]-e;let n=0;for(let t=0;t<a;++t){const e=s[t+1],r=o[a-t],u=i[t]/(e+r);i[t]=n+e*u,n=r*u}i[a]=n}return i}function Te(t,e){let n=1;for(let i=2;i<=t;++i)n*=i;let r=1;for(let i=2;i<=e;++i)r*=i;for(let i=2;i<=t-e;++i)r*=i;return n/r}function _e(t,e,n,r,o){return function(t){const e=t.length,n=[],r=[];for(let s=0;s<e;++s){const e=t[s];n[s]=new i.Vector3(e.x,e.y,e.z),r[s]=e.w}const o=[];for(let i=0;i<e;++i){const t=n[i].clone();for(let e=1;e<=i;++e)t.sub(o[i-e].clone().multiplyScalar(Te(i,e)*r[e]));o[i]=t.divideScalar(r[0])}return o}(function(t,e,n,r,o){const s=o<t?o:t,a=[],u=ke(t,r,e),c=function(t,e,n,r,i){const o=[];for(let h=0;h<=n;++h)o[h]=0;const s=[];for(let h=0;h<=r;++h)s[h]=o.slice(0);const a=[];for(let h=0;h<=n;++h)a[h]=o.slice(0);a[0][0]=1;const u=o.slice(0),c=o.slice(0);for(let h=1;h<=n;++h){u[h]=e-i[t+1-h],c[h]=i[t+h]-e;let n=0;for(let t=0;t<h;++t){const e=c[t+1],r=u[h-t];a[h][t]=e+r;const i=a[t][h-1]/a[h][t];a[t][h]=n+e*i,n=r*i}a[h][h]=n}for(let h=0;h<=n;++h)s[0][h]=a[h][n];for(let h=0;h<=n;++h){let t=0,e=1;const i=[];for(let r=0;r<=n;++r)i[r]=o.slice(0);i[0][0]=1;for(let o=1;o<=r;++o){let r=0;const u=h-o,c=n-o;h>=o&&(i[e][0]=i[t][0]/a[c+1][u],r=i[e][0]*a[u][c]);const l=h-1<=c?o-1:n-h;for(let n=u>=-1?1:-u;n<=l;++n)i[e][n]=(i[t][n]-i[t][n-1])/a[c+1][u+n],r+=i[e][n]*a[u+n][c];h<=c&&(i[e][o]=-i[t][o-1]/a[c+1][h],r+=i[e][o]*a[h][c]),s[o][h]=r;const f=t;t=e,e=f}}let l=n;for(let h=1;h<=r;++h){for(let t=0;t<=n;++t)s[h][t]*=l;l*=n-h}return s}(u,r,t,s,e),l=[];for(let i=0;i<n.length;++i){const t=n[i].clone(),e=t.w;t.x*=e,t.y*=e,t.z*=e,l[i]=t}for(let i=0;i<=s;++i){const e=l[u-t].clone().multiplyScalar(c[i][0]);for(let n=1;n<=t;++n)e.add(l[u-t+n].clone().multiplyScalar(c[i][n]));a[i]=e}for(let h=s+1;h<=o+1;++h)a[h]=new i.Vector4(0,0,0);return a}(t,e,n,r,o))}class Se extends i.Curve{constructor(t,e,n,r,o){super(),this.degree=t,this.knots=e,this.controlPoints=[],this.startKnot=r||0,this.endKnot=o||this.knots.length-1;for(let s=0;s<n.length;++s){const t=n[s];this.controlPoints[s]=new i.Vector4(t.x,t.y,t.z,t.w)}}getPoint(t,e=new i.Vector3){const n=e,r=this.knots[this.startKnot]+t*(this.knots[this.endKnot]-this.knots[this.startKnot]),o=function(t,e,n,r){const o=ke(t,r,e),s=Ee(o,r,t,e),a=new i.Vector4(0,0,0,0);for(let i=0;i<=t;++i){const e=n[o-t+i],r=s[i],u=e.w*r;a.x+=e.x*u,a.y+=e.y*u,a.z+=e.z*u,a.w+=e.w*r}return a}(this.degree,this.knots,this.controlPoints,r);return 1!==o.w&&o.divideScalar(o.w),n.set(o.x,o.y,o.z)}getTangent(t,e=new i.Vector3){const n=e,r=this.knots[0]+t*(this.knots[this.knots.length-1]-this.knots[0]),o=_e(this.degree,this.knots,this.controlPoints,r,1);return n.copy(o[1]).normalize(),n}}let Ce,Oe,Fe;class Le extends i.Loader{constructor(t){super(t)}load(t,e,n,r){const o=this,s=""===o.path?i.LoaderUtils.extractUrlBase(t):o.path,a=new i.FileLoader(this.manager);a.setPath(o.path),a.setResponseType("arraybuffer"),a.setRequestHeader(o.requestHeader),a.setWithCredentials(o.withCredentials),a.load(t,(function(n){try{e(o.parse(n,s))}catch(Je){r?r(Je):console.error(Je),o.manager.itemError(t)}}),n,r)}parse(t,e){if(function(t){const e="Kaydara FBX Binary  \0";return t.byteLength>=e.length&&e===Ke(t,0,e.length)}(t))Ce=(new Ne).parse(t);else{const e=Ke(t);if(!function(t){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let n=0;function r(e){const r=t[e-1];return t=t.slice(n+e),n++,r}for(let i=0;i<e.length;++i){if(r(1)===e[i])return!1}return!0}(e))throw new Error("THREE.FBXLoader: Unknown format.");if(Be(e)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+Be(e));Ce=(new Ve).parse(e)}const n=new i.TextureLoader(this.manager).setPath(this.resourcePath||e).setCrossOrigin(this.crossOrigin);return new Re(n,this.manager).parse(Ce)}}class Re{constructor(t,e){this.textureLoader=t,this.manager=e}parse(){Oe=this.parseConnections();const t=this.parseImages(),e=this.parseTextures(t),n=this.parseMaterials(e),r=this.parseDeformers(),i=(new De).parse(r);return this.parseScene(r,i,n),Fe}parseConnections(){const t=new Map;if("Connections"in Ce){Ce.Connections.connections.forEach((function(e){const n=e[0],r=e[1],i=e[2];t.has(n)||t.set(n,{parents:[],children:[]});const o={ID:r,relationship:i};t.get(n).parents.push(o),t.has(r)||t.set(r,{parents:[],children:[]});const s={ID:n,relationship:i};t.get(r).children.push(s)}))}return t}parseImages(){const t={},e={};if("Video"in Ce.Objects){const n=Ce.Objects.Video;for(const r in n){const i=n[r];if(t[parseInt(r)]=i.RelativeFilename||i.Filename,"Content"in i){const t=i.Content instanceof ArrayBuffer&&i.Content.byteLength>0,o="string"===typeof i.Content&&""!==i.Content;if(t||o){const t=this.parseImage(n[r]);e[i.RelativeFilename||i.Filename]=t}}}}for(const n in t){const r=t[n];void 0!==e[r]?t[n]=e[r]:t[n]=t[n].split("\\").pop()}return t}parseImage(t){const e=t.Content,n=t.RelativeFilename||t.Filename,r=n.slice(n.lastIndexOf(".")+1).toLowerCase();let i;switch(r){case"bmp":i="image/bmp";break;case"jpg":case"jpeg":i="image/jpeg";break;case"png":i="image/png";break;case"tif":i="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),i="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+r+'" is not supported.')}if("string"===typeof e)return"data:"+i+";base64,"+e;{const t=new Uint8Array(e);return window.URL.createObjectURL(new Blob([t],{type:i}))}}parseTextures(t){const e=new Map;if("Texture"in Ce.Objects){const n=Ce.Objects.Texture;for(const r in n){const i=this.parseTexture(n[r],t);e.set(parseInt(r),i)}}return e}parseTexture(t,e){const n=this.loadTexture(t,e);n.ID=t.id,n.name=t.attrName;const r=t.WrapModeU,o=t.WrapModeV,s=void 0!==r?r.value:0,a=void 0!==o?o.value:0;if(n.wrapS=0===s?i.RepeatWrapping:i.ClampToEdgeWrapping,n.wrapT=0===a?i.RepeatWrapping:i.ClampToEdgeWrapping,"Scaling"in t){const e=t.Scaling.value;n.repeat.x=e[0],n.repeat.y=e[1]}return n}loadTexture(t,e){let n;const r=this.textureLoader.path,o=Oe.get(t.id).children;let s;void 0!==o&&o.length>0&&void 0!==e[o[0].ID]&&(n=e[o[0].ID],0!==n.indexOf("blob:")&&0!==n.indexOf("data:")||this.textureLoader.setPath(void 0));const a=t.FileName.slice(-3).toLowerCase();if("tga"===a){const e=this.manager.getHandler(".tga");null===e?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",t.RelativeFilename),s=new i.Texture):(e.setPath(this.textureLoader.path),s=e.load(n))}else"psd"===a?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",t.RelativeFilename),s=new i.Texture):s=this.textureLoader.load(n);return this.textureLoader.setPath(r),s}parseMaterials(t){const e=new Map;if("Material"in Ce.Objects){const n=Ce.Objects.Material;for(const r in n){const i=this.parseMaterial(n[r],t);null!==i&&e.set(parseInt(r),i)}}return e}parseMaterial(t,e){const n=t.id,r=t.attrName;let o=t.ShadingModel;if("object"===typeof o&&(o=o.value),!Oe.has(n))return null;const s=this.parseParameters(t,e,n);let a;switch(o.toLowerCase()){case"phong":a=new i.MeshPhongMaterial;break;case"lambert":a=new i.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),a=new i.MeshPhongMaterial}return a.setValues(s),a.name=r,a}parseParameters(t,e,n){const r={};t.BumpFactor&&(r.bumpScale=t.BumpFactor.value),t.Diffuse?r.color=(new i.Color).fromArray(t.Diffuse.value):!t.DiffuseColor||"Color"!==t.DiffuseColor.type&&"ColorRGB"!==t.DiffuseColor.type||(r.color=(new i.Color).fromArray(t.DiffuseColor.value)),t.DisplacementFactor&&(r.displacementScale=t.DisplacementFactor.value),t.Emissive?r.emissive=(new i.Color).fromArray(t.Emissive.value):!t.EmissiveColor||"Color"!==t.EmissiveColor.type&&"ColorRGB"!==t.EmissiveColor.type||(r.emissive=(new i.Color).fromArray(t.EmissiveColor.value)),t.EmissiveFactor&&(r.emissiveIntensity=parseFloat(t.EmissiveFactor.value)),t.Opacity&&(r.opacity=parseFloat(t.Opacity.value)),r.opacity<1&&(r.transparent=!0),t.ReflectionFactor&&(r.reflectivity=t.ReflectionFactor.value),t.Shininess&&(r.shininess=t.Shininess.value),t.Specular?r.specular=(new i.Color).fromArray(t.Specular.value):t.SpecularColor&&"Color"===t.SpecularColor.type&&(r.specular=(new i.Color).fromArray(t.SpecularColor.value));const o=this;return Oe.get(n).children.forEach((function(t){const n=t.relationship;switch(n){case"Bump":r.bumpMap=o.getTexture(e,t.ID);break;case"Maya|TEX_ao_map":r.aoMap=o.getTexture(e,t.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=o.getTexture(e,t.ID),void 0!==r.map&&(r.map.encoding=i.sRGBEncoding);break;case"DisplacementColor":r.displacementMap=o.getTexture(e,t.ID);break;case"EmissiveColor":r.emissiveMap=o.getTexture(e,t.ID),void 0!==r.emissiveMap&&(r.emissiveMap.encoding=i.sRGBEncoding);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=o.getTexture(e,t.ID);break;case"ReflectionColor":r.envMap=o.getTexture(e,t.ID),void 0!==r.envMap&&(r.envMap.mapping=i.EquirectangularReflectionMapping,r.envMap.encoding=i.sRGBEncoding);break;case"SpecularColor":r.specularMap=o.getTexture(e,t.ID),void 0!==r.specularMap&&(r.specularMap.encoding=i.sRGBEncoding);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=o.getTexture(e,t.ID),r.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",n)}})),r}getTexture(t,e){return"LayeredTexture"in Ce.Objects&&e in Ce.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),e=Oe.get(e).children[0].ID),t.get(e)}parseDeformers(){const t={},e={};if("Deformer"in Ce.Objects){const n=Ce.Objects.Deformer;for(const r in n){const i=n[r],o=Oe.get(parseInt(r));if("Skin"===i.attrType){const e=this.parseSkeleton(o,n);e.ID=r,o.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),e.geometryID=o.parents[0].ID,t[r]=e}else if("BlendShape"===i.attrType){const t={id:r};t.rawTargets=this.parseMorphTargets(o,n),t.id=r,o.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),e[r]=t}}}return{skeletons:t,morphTargets:e}}parseSkeleton(t,e){const n=[];return t.children.forEach((function(t){const r=e[t.ID];if("Cluster"!==r.attrType)return;const o={ID:t.ID,indices:[],weights:[],transformLink:(new i.Matrix4).fromArray(r.TransformLink.a)};"Indexes"in r&&(o.indices=r.Indexes.a,o.weights=r.Weights.a),n.push(o)})),{rawBones:n,bones:[]}}parseMorphTargets(t,e){const n=[];for(let r=0;r<t.children.length;r++){const i=t.children[r],o=e[i.ID],s={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if("BlendShapeChannel"!==o.attrType)return;s.geoID=Oe.get(parseInt(i.ID)).children.filter((function(t){return void 0===t.relationship}))[0].ID,n.push(s)}return n}parseScene(t,e,n){Fe=new i.Group;const r=this.parseModels(t.skeletons,e,n),o=Ce.Objects.Model,s=this;r.forEach((function(t){const e=o[t.ID];s.setLookAtProperties(t,e);Oe.get(t.ID).parents.forEach((function(e){const n=r.get(e.ID);void 0!==n&&n.add(t)})),null===t.parent&&Fe.add(t)})),this.bindSkeleton(t.skeletons,e,r),this.createAmbientLight(),Fe.traverse((function(t){if(t.userData.transformData){t.parent&&(t.userData.transformData.parentMatrix=t.parent.matrix,t.userData.transformData.parentMatrixWorld=t.parent.matrixWorld);const e=He(t.userData.transformData);t.applyMatrix4(e),t.updateWorldMatrix()}}));const a=(new je).parse();1===Fe.children.length&&Fe.children[0].isGroup&&(Fe.children[0].animations=a,Fe=Fe.children[0]),Fe.animations=a}parseModels(t,e,n){const r=new Map,o=Ce.Objects.Model;for(const s in o){const a=parseInt(s),u=o[s],c=Oe.get(a);let l=this.buildSkeleton(c,t,a,u.attrName);if(!l){switch(u.attrType){case"Camera":l=this.createCamera(c);break;case"Light":l=this.createLight(c);break;case"Mesh":l=this.createMesh(c,e,n);break;case"NurbsCurve":l=this.createCurve(c,e);break;case"LimbNode":case"Root":l=new i.Bone;break;case"Null":default:l=new i.Group}l.name=u.attrName?i.PropertyBinding.sanitizeNodeName(u.attrName):"",l.ID=a}this.getTransformData(l,u),r.set(a,l)}return r}buildSkeleton(t,e,n,r){let o=null;return t.parents.forEach((function(t){for(const s in e){const a=e[s];a.rawBones.forEach((function(e,s){if(e.ID===t.ID){const t=o;o=new i.Bone,o.matrixWorld.copy(e.transformLink),o.name=r?i.PropertyBinding.sanitizeNodeName(r):"",o.ID=n,a.bones[s]=o,null!==t&&o.add(t)}}))}})),o}createCamera(t){let e,n;if(t.children.forEach((function(t){const e=Ce.Objects.NodeAttribute[t.ID];void 0!==e&&(n=e)})),void 0===n)e=new i.Object3D;else{let t=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(t=1);let r=1;void 0!==n.NearPlane&&(r=n.NearPlane.value/1e3);let o=1e3;void 0!==n.FarPlane&&(o=n.FarPlane.value/1e3);let s=window.innerWidth,a=window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(s=n.AspectWidth.value,a=n.AspectHeight.value);const u=s/a;let c=45;void 0!==n.FieldOfView&&(c=n.FieldOfView.value);const l=n.FocalLength?n.FocalLength.value:null;switch(t){case 0:e=new i.PerspectiveCamera(c,u,r,o),null!==l&&e.setFocalLength(l);break;case 1:e=new i.OrthographicCamera(-s/2,s/2,a/2,-a/2,r,o);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+t+"."),e=new i.Object3D}}return e}createLight(t){let e,n;if(t.children.forEach((function(t){const e=Ce.Objects.NodeAttribute[t.ID];void 0!==e&&(n=e)})),void 0===n)e=new i.Object3D;else{let t;t=void 0===n.LightType?0:n.LightType.value;let r=16777215;void 0!==n.Color&&(r=(new i.Color).fromArray(n.Color.value));let o=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(o=0);let s=0;void 0!==n.FarAttenuationEnd&&(s=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);const a=1;switch(t){case 0:e=new i.PointLight(r,o,s,a);break;case 1:e=new i.DirectionalLight(r,o);break;case 2:let t=Math.PI/3;void 0!==n.InnerAngle&&(t=i.MathUtils.degToRad(n.InnerAngle.value));let u=0;void 0!==n.OuterAngle&&(u=i.MathUtils.degToRad(n.OuterAngle.value),u=Math.max(u,1)),e=new i.SpotLight(r,o,s,t,u,a);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),e=new i.PointLight(r,o)}void 0!==n.CastShadows&&1===n.CastShadows.value&&(e.castShadow=!0)}return e}createMesh(t,e,n){let r,o=null,s=null;const a=[];return t.children.forEach((function(t){e.has(t.ID)&&(o=e.get(t.ID)),n.has(t.ID)&&a.push(n.get(t.ID))})),a.length>1?s=a:a.length>0?s=a[0]:(s=new i.MeshPhongMaterial({color:13421772}),a.push(s)),"color"in o.attributes&&a.forEach((function(t){t.vertexColors=!0})),o.FBX_Deformer?(r=new i.SkinnedMesh(o,s),r.normalizeSkinWeights()):r=new i.Mesh(o,s),r}createCurve(t,e){const n=t.children.reduce((function(t,n){return e.has(n.ID)&&(t=e.get(n.ID)),t}),null),r=new i.LineBasicMaterial({color:3342591,linewidth:1});return new i.Line(n,r)}getTransformData(t,e){const n={};"InheritType"in e&&(n.inheritType=parseInt(e.InheritType.value)),n.eulerOrder="RotationOrder"in e?Qe(e.RotationOrder.value):"ZYX","Lcl_Translation"in e&&(n.translation=e.Lcl_Translation.value),"PreRotation"in e&&(n.preRotation=e.PreRotation.value),"Lcl_Rotation"in e&&(n.rotation=e.Lcl_Rotation.value),"PostRotation"in e&&(n.postRotation=e.PostRotation.value),"Lcl_Scaling"in e&&(n.scale=e.Lcl_Scaling.value),"ScalingOffset"in e&&(n.scalingOffset=e.ScalingOffset.value),"ScalingPivot"in e&&(n.scalingPivot=e.ScalingPivot.value),"RotationOffset"in e&&(n.rotationOffset=e.RotationOffset.value),"RotationPivot"in e&&(n.rotationPivot=e.RotationPivot.value),t.userData.transformData=n}setLookAtProperties(t,e){if("LookAtProperty"in e){Oe.get(t.ID).children.forEach((function(e){if("LookAtProperty"===e.relationship){const n=Ce.Objects.Model[e.ID];if("Lcl_Translation"in n){const e=n.Lcl_Translation.value;void 0!==t.target?(t.target.position.fromArray(e),Fe.add(t.target)):t.lookAt((new i.Vector3).fromArray(e))}}}))}}bindSkeleton(t,e,n){const r=this.parsePoseNodes();for(const o in t){const s=t[o];Oe.get(parseInt(s.ID)).parents.forEach((function(t){if(e.has(t.ID)){const e=t.ID;Oe.get(e).parents.forEach((function(t){if(n.has(t.ID)){n.get(t.ID).bind(new i.Skeleton(s.bones),r[t.ID])}}))}}))}}parsePoseNodes(){const t={};if("Pose"in Ce.Objects){const e=Ce.Objects.Pose;for(const n in e)if("BindPose"===e[n].attrType&&e[n].NbPoseNodes>0){const r=e[n].PoseNode;Array.isArray(r)?r.forEach((function(e){t[e.Node]=(new i.Matrix4).fromArray(e.Matrix.a)})):t[r.Node]=(new i.Matrix4).fromArray(r.Matrix.a)}}return t}createAmbientLight(){if("GlobalSettings"in Ce&&"AmbientColor"in Ce.GlobalSettings){const t=Ce.GlobalSettings.AmbientColor.value,e=t[0],n=t[1],r=t[2];if(0!==e||0!==n||0!==r){const t=new i.Color(e,n,r);Fe.add(new i.AmbientLight(t,1))}}}}class De{parse(t){const e=new Map;if("Geometry"in Ce.Objects){const n=Ce.Objects.Geometry;for(const r in n){const i=Oe.get(parseInt(r)),o=this.parseGeometry(i,n[r],t);e.set(parseInt(r),o)}}return e}parseGeometry(t,e,n){switch(e.attrType){case"Mesh":return this.parseMeshGeometry(t,e,n);case"NurbsCurve":return this.parseNurbsGeometry(e)}}parseMeshGeometry(t,e,n){const r=n.skeletons,i=[],o=t.parents.map((function(t){return Ce.Objects.Model[t.ID]}));if(0===o.length)return;const s=t.children.reduce((function(t,e){return void 0!==r[e.ID]&&(t=r[e.ID]),t}),null);t.children.forEach((function(t){void 0!==n.morphTargets[t.ID]&&i.push(n.morphTargets[t.ID])}));const a=o[0],u={};"RotationOrder"in a&&(u.eulerOrder=Qe(a.RotationOrder.value)),"InheritType"in a&&(u.inheritType=parseInt(a.InheritType.value)),"GeometricTranslation"in a&&(u.translation=a.GeometricTranslation.value),"GeometricRotation"in a&&(u.rotation=a.GeometricRotation.value),"GeometricScaling"in a&&(u.scale=a.GeometricScaling.value);const c=He(u);return this.genGeometry(e,s,i,c)}genGeometry(t,e,n,r){const o=new i.BufferGeometry;t.attrName&&(o.name=t.attrName);const s=this.parseGeoNode(t,e),a=this.genBuffers(s),u=new i.Float32BufferAttribute(a.vertex,3);if(u.applyMatrix4(r),o.setAttribute("position",u),a.colors.length>0&&o.setAttribute("color",new i.Float32BufferAttribute(a.colors,3)),e&&(o.setAttribute("skinIndex",new i.Uint16BufferAttribute(a.weightsIndices,4)),o.setAttribute("skinWeight",new i.Float32BufferAttribute(a.vertexWeights,4)),o.FBX_Deformer=e),a.normal.length>0){const t=(new i.Matrix3).getNormalMatrix(r),e=new i.Float32BufferAttribute(a.normal,3);e.applyNormalMatrix(t),o.setAttribute("normal",e)}if(a.uvs.forEach((function(t,e){let n="uv"+(e+1).toString();0===e&&(n="uv"),o.setAttribute(n,new i.Float32BufferAttribute(a.uvs[e],2))})),s.material&&"AllSame"!==s.material.mappingType){let t=a.materialIndex[0],e=0;if(a.materialIndex.forEach((function(n,r){n!==t&&(o.addGroup(e,r-e,t),t=n,e=r)})),o.groups.length>0){const e=o.groups[o.groups.length-1],n=e.start+e.count;n!==a.materialIndex.length&&o.addGroup(n,a.materialIndex.length-n,t)}0===o.groups.length&&o.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(o,t,n,r),o}parseGeoNode(t,e){const n={};if(n.vertexPositions=void 0!==t.Vertices?t.Vertices.a:[],n.vertexIndices=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],t.LayerElementColor&&(n.color=this.parseVertexColors(t.LayerElementColor[0])),t.LayerElementMaterial&&(n.material=this.parseMaterialIndices(t.LayerElementMaterial[0])),t.LayerElementNormal&&(n.normal=this.parseNormals(t.LayerElementNormal[0])),t.LayerElementUV){n.uv=[];let e=0;for(;t.LayerElementUV[e];)t.LayerElementUV[e].UV&&n.uv.push(this.parseUVs(t.LayerElementUV[e])),e++}return n.weightTable={},null!==e&&(n.skeleton=e,e.rawBones.forEach((function(t,e){t.indices.forEach((function(r,i){void 0===n.weightTable[r]&&(n.weightTable[r]=[]),n.weightTable[r].push({id:e,weight:t.weights[i]})}))}))),n}genBuffers(t){const e={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,r=0,i=!1,o=[],s=[],a=[],u=[],c=[],l=[];const h=this;return t.vertexIndices.forEach((function(f,p){let d,m=!1;f<0&&(f^=-1,m=!0);let g=[],v=[];if(o.push(3*f,3*f+1,3*f+2),t.color){const e=qe(p,n,f,t.color);a.push(e[0],e[1],e[2])}if(t.skeleton){if(void 0!==t.weightTable[f]&&t.weightTable[f].forEach((function(t){v.push(t.weight),g.push(t.id)})),v.length>4){i||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);const t=[0,0,0,0],e=[0,0,0,0];v.forEach((function(n,r){let i=n,o=g[r];e.forEach((function(e,n,r){if(i>e){r[n]=i,i=e;const s=t[n];t[n]=o,o=s}}))})),g=t,v=e}for(;v.length<4;)v.push(0),g.push(0);for(let t=0;t<4;++t)c.push(v[t]),l.push(g[t])}if(t.normal){const e=qe(p,n,f,t.normal);s.push(e[0],e[1],e[2])}t.material&&"AllSame"!==t.material.mappingType&&(d=qe(p,n,f,t.material)[0]),t.uv&&t.uv.forEach((function(t,e){const r=qe(p,n,f,t);void 0===u[e]&&(u[e]=[]),u[e].push(r[0]),u[e].push(r[1])})),r++,m&&(h.genFace(e,t,o,d,s,a,u,c,l,r),n++,r=0,o=[],s=[],a=[],u=[],c=[],l=[])})),e}genFace(t,e,n,r,i,o,s,a,u,c){for(let l=2;l<c;l++)t.vertex.push(e.vertexPositions[n[0]]),t.vertex.push(e.vertexPositions[n[1]]),t.vertex.push(e.vertexPositions[n[2]]),t.vertex.push(e.vertexPositions[n[3*(l-1)]]),t.vertex.push(e.vertexPositions[n[3*(l-1)+1]]),t.vertex.push(e.vertexPositions[n[3*(l-1)+2]]),t.vertex.push(e.vertexPositions[n[3*l]]),t.vertex.push(e.vertexPositions[n[3*l+1]]),t.vertex.push(e.vertexPositions[n[3*l+2]]),e.skeleton&&(t.vertexWeights.push(a[0]),t.vertexWeights.push(a[1]),t.vertexWeights.push(a[2]),t.vertexWeights.push(a[3]),t.vertexWeights.push(a[4*(l-1)]),t.vertexWeights.push(a[4*(l-1)+1]),t.vertexWeights.push(a[4*(l-1)+2]),t.vertexWeights.push(a[4*(l-1)+3]),t.vertexWeights.push(a[4*l]),t.vertexWeights.push(a[4*l+1]),t.vertexWeights.push(a[4*l+2]),t.vertexWeights.push(a[4*l+3]),t.weightsIndices.push(u[0]),t.weightsIndices.push(u[1]),t.weightsIndices.push(u[2]),t.weightsIndices.push(u[3]),t.weightsIndices.push(u[4*(l-1)]),t.weightsIndices.push(u[4*(l-1)+1]),t.weightsIndices.push(u[4*(l-1)+2]),t.weightsIndices.push(u[4*(l-1)+3]),t.weightsIndices.push(u[4*l]),t.weightsIndices.push(u[4*l+1]),t.weightsIndices.push(u[4*l+2]),t.weightsIndices.push(u[4*l+3])),e.color&&(t.colors.push(o[0]),t.colors.push(o[1]),t.colors.push(o[2]),t.colors.push(o[3*(l-1)]),t.colors.push(o[3*(l-1)+1]),t.colors.push(o[3*(l-1)+2]),t.colors.push(o[3*l]),t.colors.push(o[3*l+1]),t.colors.push(o[3*l+2])),e.material&&"AllSame"!==e.material.mappingType&&(t.materialIndex.push(r),t.materialIndex.push(r),t.materialIndex.push(r)),e.normal&&(t.normal.push(i[0]),t.normal.push(i[1]),t.normal.push(i[2]),t.normal.push(i[3*(l-1)]),t.normal.push(i[3*(l-1)+1]),t.normal.push(i[3*(l-1)+2]),t.normal.push(i[3*l]),t.normal.push(i[3*l+1]),t.normal.push(i[3*l+2])),e.uv&&e.uv.forEach((function(e,n){void 0===t.uvs[n]&&(t.uvs[n]=[]),t.uvs[n].push(s[n][0]),t.uvs[n].push(s[n][1]),t.uvs[n].push(s[n][2*(l-1)]),t.uvs[n].push(s[n][2*(l-1)+1]),t.uvs[n].push(s[n][2*l]),t.uvs[n].push(s[n][2*l+1])}))}addMorphTargets(t,e,n,r){if(0===n.length)return;t.morphTargetsRelative=!0,t.morphAttributes.position=[];const i=this;n.forEach((function(n){n.rawTargets.forEach((function(n){const o=Ce.Objects.Geometry[n.geoID];void 0!==o&&i.genMorphGeometry(t,e,o,r,n.name)}))}))}genMorphGeometry(t,e,n,r,o){const s=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],a=void 0!==n.Vertices?n.Vertices.a:[],u=void 0!==n.Indexes?n.Indexes.a:[],c=3*t.attributes.position.count,l=new Float32Array(c);for(let i=0;i<u.length;i++){const t=3*u[i];l[t]=a[3*i],l[t+1]=a[3*i+1],l[t+2]=a[3*i+2]}const h={vertexIndices:s,vertexPositions:l},f=this.genBuffers(h),p=new i.Float32BufferAttribute(f.vertex,3);p.name=o||n.attrName,p.applyMatrix4(r),t.morphAttributes.position.push(p)}parseNormals(t){const e=t.MappingInformationType,n=t.ReferenceInformationType,r=t.Normals.a;let i=[];return"IndexToDirect"===n&&("NormalIndex"in t?i=t.NormalIndex.a:"NormalsIndex"in t&&(i=t.NormalsIndex.a)),{dataSize:3,buffer:r,indices:i,mappingType:e,referenceType:n}}parseUVs(t){const e=t.MappingInformationType,n=t.ReferenceInformationType,r=t.UV.a;let i=[];return"IndexToDirect"===n&&(i=t.UVIndex.a),{dataSize:2,buffer:r,indices:i,mappingType:e,referenceType:n}}parseVertexColors(t){const e=t.MappingInformationType,n=t.ReferenceInformationType,r=t.Colors.a;let i=[];return"IndexToDirect"===n&&(i=t.ColorIndex.a),{dataSize:4,buffer:r,indices:i,mappingType:e,referenceType:n}}parseMaterialIndices(t){const e=t.MappingInformationType,n=t.ReferenceInformationType;if("NoMappingInformation"===e)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const r=t.Materials.a,i=[];for(let o=0;o<r.length;++o)i.push(o);return{dataSize:1,buffer:r,indices:i,mappingType:e,referenceType:n}}parseNurbsGeometry(t){if(void 0===Se)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new i.BufferGeometry;const e=parseInt(t.Order);if(isNaN(e))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",t.Order,t.id),new i.BufferGeometry;const n=e-1,r=t.KnotVector.a,o=[],s=t.Points.a;for(let l=0,h=s.length;l<h;l+=4)o.push((new i.Vector4).fromArray(s,l));let a,u;if("Closed"===t.Form)o.push(o[0]);else if("Periodic"===t.Form){a=n,u=r.length-1-a;for(let t=0;t<n;++t)o.push(o[t])}const c=new Se(n,r,o,a,u).getPoints(12*o.length);return(new i.BufferGeometry).setFromPoints(c)}}class je{parse(){const t=[],e=this.parseClips();if(void 0!==e)for(const n in e){const r=e[n],i=this.addClip(r);t.push(i)}return t}parseClips(){if(void 0===Ce.Objects.AnimationCurve)return;const t=this.parseAnimationCurveNodes();this.parseAnimationCurves(t);const e=this.parseAnimationLayers(t);return this.parseAnimStacks(e)}parseAnimationCurveNodes(){const t=Ce.Objects.AnimationCurveNode,e=new Map;for(const n in t){const r=t[n];if(null!==r.attrName.match(/S|R|T|DeformPercent/)){const t={id:r.id,attr:r.attrName,curves:{}};e.set(t.id,t)}}return e}parseAnimationCurves(t){const e=Ce.Objects.AnimationCurve;for(const n in e){const r={id:e[n].id,times:e[n].KeyTime.a.map(We),values:e[n].KeyValueFloat.a},i=Oe.get(r.id);if(void 0!==i){const e=i.parents[0].ID,n=i.parents[0].relationship;n.match(/X/)?t.get(e).curves.x=r:n.match(/Y/)?t.get(e).curves.y=r:n.match(/Z/)?t.get(e).curves.z=r:n.match(/d|DeformPercent/)&&t.has(e)&&(t.get(e).curves.morph=r)}}}parseAnimationLayers(t){const e=Ce.Objects.AnimationLayer,n=new Map;for(const r in e){const e=[],o=Oe.get(parseInt(r));if(void 0!==o){o.children.forEach((function(n,r){if(t.has(n.ID)){const o=t.get(n.ID);if(void 0!==o.curves.x||void 0!==o.curves.y||void 0!==o.curves.z){if(void 0===e[r]){const t=Oe.get(n.ID).parents.filter((function(t){return void 0!==t.relationship}))[0].ID;if(void 0!==t){const o=Ce.Objects.Model[t.toString()];if(void 0===o)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",n);const s={modelName:o.attrName?i.PropertyBinding.sanitizeNodeName(o.attrName):"",ID:o.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Fe.traverse((function(t){t.ID===o.id&&(s.transform=t.matrix,t.userData.transformData&&(s.eulerOrder=t.userData.transformData.eulerOrder))})),s.transform||(s.transform=new i.Matrix4),"PreRotation"in o&&(s.preRotation=o.PreRotation.value),"PostRotation"in o&&(s.postRotation=o.PostRotation.value),e[r]=s}}e[r]&&(e[r][o.attr]=o)}else if(void 0!==o.curves.morph){if(void 0===e[r]){const t=Oe.get(n.ID).parents.filter((function(t){return void 0!==t.relationship}))[0].ID,o=Oe.get(t).parents[0].ID,s=Oe.get(o).parents[0].ID,a=Oe.get(s).parents[0].ID,u=Ce.Objects.Model[a],c={modelName:u.attrName?i.PropertyBinding.sanitizeNodeName(u.attrName):"",morphName:Ce.Objects.Deformer[t].attrName};e[r]=c}e[r][o.attr]=o}}})),n.set(parseInt(r),e)}}return n}parseAnimStacks(t){const e=Ce.Objects.AnimationStack,n={};for(const r in e){const i=Oe.get(parseInt(r)).children;i.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const o=t.get(i[0].ID);n[r]={name:e[r].attrName,layer:o}}return n}addClip(t){let e=[];const n=this;return t.layer.forEach((function(t){e=e.concat(n.generateTracks(t))})),new i.AnimationClip(t.name,-1,e)}generateTracks(t){const e=[];let n=new i.Vector3,r=new i.Quaternion,o=new i.Vector3;if(t.transform&&t.transform.decompose(n,r,o),n=n.toArray(),r=(new i.Euler).setFromQuaternion(r,t.eulerOrder).toArray(),o=o.toArray(),void 0!==t.T&&Object.keys(t.T.curves).length>0){const r=this.generateVectorTrack(t.modelName,t.T.curves,n,"position");void 0!==r&&e.push(r)}if(void 0!==t.R&&Object.keys(t.R.curves).length>0){const n=this.generateRotationTrack(t.modelName,t.R.curves,r,t.preRotation,t.postRotation,t.eulerOrder);void 0!==n&&e.push(n)}if(void 0!==t.S&&Object.keys(t.S.curves).length>0){const n=this.generateVectorTrack(t.modelName,t.S.curves,o,"scale");void 0!==n&&e.push(n)}if(void 0!==t.DeformPercent){const n=this.generateMorphTrack(t);void 0!==n&&e.push(n)}return e}generateVectorTrack(t,e,n,r){const o=this.getTimesForAllAxes(e),s=this.getKeyframeTrackValues(o,e,n);return new i.VectorKeyframeTrack(t+"."+r,o,s)}generateRotationTrack(t,e,n,r,o,s){void 0!==e.x&&(this.interpolateRotations(e.x),e.x.values=e.x.values.map(i.MathUtils.degToRad)),void 0!==e.y&&(this.interpolateRotations(e.y),e.y.values=e.y.values.map(i.MathUtils.degToRad)),void 0!==e.z&&(this.interpolateRotations(e.z),e.z.values=e.z.values.map(i.MathUtils.degToRad));const a=this.getTimesForAllAxes(e),u=this.getKeyframeTrackValues(a,e,n);void 0!==r&&((r=r.map(i.MathUtils.degToRad)).push(s),r=(new i.Euler).fromArray(r),r=(new i.Quaternion).setFromEuler(r)),void 0!==o&&((o=o.map(i.MathUtils.degToRad)).push(s),o=(new i.Euler).fromArray(o),o=(new i.Quaternion).setFromEuler(o).invert());const c=new i.Quaternion,l=new i.Euler,h=[];for(let i=0;i<u.length;i+=3)l.set(u[i],u[i+1],u[i+2],s),c.setFromEuler(l),void 0!==r&&c.premultiply(r),void 0!==o&&c.multiply(o),c.toArray(h,i/3*4);return new i.QuaternionKeyframeTrack(t+".quaternion",a,h)}generateMorphTrack(t){const e=t.DeformPercent.curves.morph,n=e.values.map((function(t){return t/100})),r=Fe.getObjectByName(t.modelName).morphTargetDictionary[t.morphName];return new i.NumberKeyframeTrack(t.modelName+".morphTargetInfluences["+r+"]",e.times,n)}getTimesForAllAxes(t){let e=[];if(void 0!==t.x&&(e=e.concat(t.x.times)),void 0!==t.y&&(e=e.concat(t.y.times)),void 0!==t.z&&(e=e.concat(t.z.times)),e=e.sort((function(t,e){return t-e})),e.length>1){let t=1,n=e[0];for(let r=1;r<e.length;r++){const i=e[r];i!==n&&(e[t]=i,n=i,t++)}e=e.slice(0,t)}return e}getKeyframeTrackValues(t,e,n){const r=n,i=[];let o=-1,s=-1,a=-1;return t.forEach((function(t){if(e.x&&(o=e.x.times.indexOf(t)),e.y&&(s=e.y.times.indexOf(t)),e.z&&(a=e.z.times.indexOf(t)),-1!==o){const t=e.x.values[o];i.push(t),r[0]=t}else i.push(r[0]);if(-1!==s){const t=e.y.values[s];i.push(t),r[1]=t}else i.push(r[1]);if(-1!==a){const t=e.z.values[a];i.push(t),r[2]=t}else i.push(r[2])})),i}interpolateRotations(t){for(let e=1;e<t.values.length;e++){const n=t.values[e-1],r=t.values[e]-n,i=Math.abs(r);if(i>=180){const o=i/180,s=r/o;let a=n+s;const u=t.times[e-1],c=(t.times[e]-u)/o;let l=u+c;const h=[],f=[];for(;l<t.times[e];)h.push(l),l+=c,f.push(a),a+=s;t.times=Ye(t.times,e,h),t.values=Ye(t.values,e,f)}}}}class Ve{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(t){this.nodeStack.push(t),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(t,e){this.currentProp=t,this.currentPropName=e}parse(t){this.currentIndent=0,this.allNodes=new Ue,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const e=this,n=t.split(/[\r\n]+/);return n.forEach((function(t,r){const i=t.match(/^[\s\t]*;/),o=t.match(/^[\s\t]*$/);if(i||o)return;const s=t.match("^\\t{"+e.currentIndent+"}(\\w+):(.*){",""),a=t.match("^\\t{"+e.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),u=t.match("^\\t{"+(e.currentIndent-1)+"}}");s?e.parseNodeBegin(t,s):a?e.parseNodeProperty(t,a,n[++r]):u?e.popStack():t.match(/^[^\s\t}]/)&&e.parseNodePropertyContinued(t)})),this.allNodes}parseNodeBegin(t,e){const n=e[1].trim().replace(/^"/,"").replace(/"$/,""),r=e[2].split(",").map((function(t){return t.trim().replace(/^"/,"").replace(/"$/,"")})),i={name:n},o=this.parseNodeAttr(r),s=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(n,i):n in s?("PoseNode"===n?s.PoseNode.push(i):void 0!==s[n].id&&(s[n]={},s[n][s[n].id]=s[n]),""!==o.id&&(s[n][o.id]=i)):"number"===typeof o.id?(s[n]={},s[n][o.id]=i):"Properties70"!==n&&(s[n]="PoseNode"===n?[i]:i),"number"===typeof o.id&&(i.id=o.id),""!==o.name&&(i.attrName=o.name),""!==o.type&&(i.attrType=o.type),this.pushStack(i)}parseNodeAttr(t){let e=t[0];""!==t[0]&&(e=parseInt(t[0]),isNaN(e)&&(e=t[0]));let n="",r="";return t.length>1&&(n=t[1].replace(/^(\w+)::/,""),r=t[2]),{id:e,name:n,type:r}}parseNodeProperty(t,e,n){let r=e[1].replace(/^"/,"").replace(/"$/,"").trim(),i=e[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===r&&","===i&&(i=n.replace(/"/g,"").replace(/,$/,"").trim());const o=this.getCurrentNode();if("Properties70"!==o.name){if("C"===r){const t=i.split(",").slice(1),e=parseInt(t[0]),n=parseInt(t[1]);let s=i.split(",").slice(3);s=s.map((function(t){return t.trim().replace(/^"/,"")})),r="connections",i=[e,n],function(t,e){for(let n=0,r=t.length,i=e.length;n<i;n++,r++)t[r]=e[n]}(i,s),void 0===o[r]&&(o[r]=[])}"Node"===r&&(o.id=i),r in o&&Array.isArray(o[r])?o[r].push(i):"a"!==r?o[r]=i:o.a=i,this.setCurrentProp(o,r),"a"===r&&","!==i.slice(-1)&&(o.a=Ze(i))}else this.parseNodeSpecialProperty(t,r,i)}parseNodePropertyContinued(t){const e=this.getCurrentNode();e.a+=t,","!==t.slice(-1)&&(e.a=Ze(e.a))}parseNodeSpecialProperty(t,e,n){const r=n.split('",').map((function(t){return t.trim().replace(/^\"/,"").replace(/\s/,"_")})),i=r[0],o=r[1],s=r[2],a=r[3];let u=r[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":u=parseFloat(u);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":u=Ze(u)}this.getPrevNode()[i]={type:o,type2:s,flag:a,value:u},this.setCurrentProp(this.getPrevNode(),i)}}class Ne{parse(t){const e=new ze(t);e.skip(23);const n=e.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const r=new Ue;for(;!this.endOfContent(e);){const t=this.parseNode(e,n);null!==t&&r.add(t.name,t)}return r}endOfContent(t){return t.size()%16===0?(t.getOffset()+160+16&-16)>=t.size():t.getOffset()+160+16>=t.size()}parseNode(t,e){const n={},r=e>=7500?t.getUint64():t.getUint32(),i=e>=7500?t.getUint64():t.getUint32();e>=7500?t.getUint64():t.getUint32();const o=t.getUint8(),s=t.getString(o);if(0===r)return null;const a=[];for(let h=0;h<i;h++)a.push(this.parseProperty(t));const u=a.length>0?a[0]:"",c=a.length>1?a[1]:"",l=a.length>2?a[2]:"";for(n.singleProperty=1===i&&t.getOffset()===r;r>t.getOffset();){const r=this.parseNode(t,e);null!==r&&this.parseSubNode(s,n,r)}return n.propertyList=a,"number"===typeof u&&(n.id=u),""!==c&&(n.attrName=c),""!==l&&(n.attrType=l),""!==s&&(n.name=s),n}parseSubNode(t,e,n){if(!0===n.singleProperty){const t=n.propertyList[0];Array.isArray(t)?(e[n.name]=n,n.a=t):e[n.name]=t}else if("Connections"===t&&"C"===n.name){const t=[];n.propertyList.forEach((function(e,n){0!==n&&t.push(e)})),void 0===e.connections&&(e.connections=[]),e.connections.push(t)}else if("Properties70"===n.name){Object.keys(n).forEach((function(t){e[t]=n[t]}))}else if("Properties70"===t&&"P"===n.name){let t=n.propertyList[0],r=n.propertyList[1];const i=n.propertyList[2],o=n.propertyList[3];let s;0===t.indexOf("Lcl ")&&(t=t.replace("Lcl ","Lcl_")),0===r.indexOf("Lcl ")&&(r=r.replace("Lcl ","Lcl_")),s="Color"===r||"ColorRGB"===r||"Vector"===r||"Vector3D"===r||0===r.indexOf("Lcl_")?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],e[t]={type:r,type2:i,flag:o,value:s}}else void 0===e[n.name]?"number"===typeof n.id?(e[n.name]={},e[n.name][n.id]=n):e[n.name]=n:"PoseNode"===n.name?(Array.isArray(e[n.name])||(e[n.name]=[e[n.name]]),e[n.name].push(n)):void 0===e[n.name][n.id]&&(e[n.name][n.id]=n)}parseProperty(t){const e=t.getString(1);let n;switch(e){case"C":return t.getBoolean();case"D":return t.getFloat64();case"F":return t.getFloat32();case"I":return t.getInt32();case"L":return t.getInt64();case"R":return n=t.getUint32(),t.getArrayBuffer(n);case"S":return n=t.getUint32(),t.getString(n);case"Y":return t.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const i=t.getUint32(),o=t.getUint32(),s=t.getUint32();if(0===o)switch(e){case"b":case"c":return t.getBooleanArray(i);case"d":return t.getFloat64Array(i);case"f":return t.getFloat32Array(i);case"i":return t.getInt32Array(i);case"l":return t.getInt64Array(i)}"undefined"===typeof r&&console.error("THREE.FBXLoader: External library fflate.min.js required.");const a=Xt(new Uint8Array(t.getArrayBuffer(s))),u=new ze(a.buffer);switch(e){case"b":case"c":return u.getBooleanArray(i);case"d":return u.getFloat64Array(i);case"f":return u.getFloat32Array(i);case"i":return u.getInt32Array(i);case"l":return u.getInt64Array(i)}default:throw new Error("THREE.FBXLoader: Unknown property type "+e)}}}class ze{constructor(t,e){this.dv=new DataView(t),this.offset=0,this.littleEndian=void 0===e||e}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(t){this.offset+=t}getBoolean(){return 1===(1&this.getUint8())}getBooleanArray(t){const e=[];for(let n=0;n<t;n++)e.push(this.getBoolean());return e}getUint8(){const t=this.dv.getUint8(this.offset);return this.offset+=1,t}getInt16(){const t=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}getInt32(){const t=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}getInt32Array(t){const e=[];for(let n=0;n<t;n++)e.push(this.getInt32());return e}getUint32(){const t=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}getInt64(){let t,e;return this.littleEndian?(t=this.getUint32(),e=this.getUint32()):(e=this.getUint32(),t=this.getUint32()),2147483648&e?(e=4294967295&~e,t=4294967295&~t,4294967295===t&&(e=e+1&4294967295),t=t+1&4294967295,-(4294967296*e+t)):4294967296*e+t}getInt64Array(t){const e=[];for(let n=0;n<t;n++)e.push(this.getInt64());return e}getUint64(){let t,e;return this.littleEndian?(t=this.getUint32(),e=this.getUint32()):(e=this.getUint32(),t=this.getUint32()),4294967296*e+t}getFloat32(){const t=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}getFloat32Array(t){const e=[];for(let n=0;n<t;n++)e.push(this.getFloat32());return e}getFloat64(){const t=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}getFloat64Array(t){const e=[];for(let n=0;n<t;n++)e.push(this.getFloat64());return e}getArrayBuffer(t){const e=this.dv.buffer.slice(this.offset,this.offset+t);return this.offset+=t,e}getString(t){let e=[];for(let r=0;r<t;r++)e[r]=this.getUint8();const n=e.indexOf(0);return n>=0&&(e=e.slice(0,n)),i.LoaderUtils.decodeText(new Uint8Array(e))}}class Ue{add(t,e){this[t]=e}}function Be(t){const e=t.match(/FBXVersion: (\d+)/);if(e){return parseInt(e[1])}throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function We(t){return t/46186158e3}const Ge=[];function qe(t,e,n,r){let i;switch(r.mappingType){case"ByPolygonVertex":i=t;break;case"ByPolygon":i=e;break;case"ByVertice":i=n;break;case"AllSame":i=r.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+r.mappingType)}"IndexToDirect"===r.referenceType&&(i=r.indices[i]);const o=i*r.dataSize,s=o+r.dataSize;return function(t,e,n,r){for(let i=n,o=0;i<r;i++,o++)t[o]=e[i];return t}(Ge,r.buffer,o,s)}const $e=new i.Euler,Xe=new i.Vector3;function He(t){const e=new i.Matrix4,n=new i.Matrix4,r=new i.Matrix4,o=new i.Matrix4,s=new i.Matrix4,a=new i.Matrix4,u=new i.Matrix4,c=new i.Matrix4,l=new i.Matrix4,h=new i.Matrix4,f=new i.Matrix4,p=new i.Matrix4,d=t.inheritType?t.inheritType:0;if(t.translation&&e.setPosition(Xe.fromArray(t.translation)),t.preRotation){const e=t.preRotation.map(i.MathUtils.degToRad);e.push(t.eulerOrder),n.makeRotationFromEuler($e.fromArray(e))}if(t.rotation){const e=t.rotation.map(i.MathUtils.degToRad);e.push(t.eulerOrder),r.makeRotationFromEuler($e.fromArray(e))}if(t.postRotation){const e=t.postRotation.map(i.MathUtils.degToRad);e.push(t.eulerOrder),o.makeRotationFromEuler($e.fromArray(e)),o.invert()}t.scale&&s.scale(Xe.fromArray(t.scale)),t.scalingOffset&&u.setPosition(Xe.fromArray(t.scalingOffset)),t.scalingPivot&&a.setPosition(Xe.fromArray(t.scalingPivot)),t.rotationOffset&&c.setPosition(Xe.fromArray(t.rotationOffset)),t.rotationPivot&&l.setPosition(Xe.fromArray(t.rotationPivot)),t.parentMatrixWorld&&(f.copy(t.parentMatrix),h.copy(t.parentMatrixWorld));const m=n.clone().multiply(r).multiply(o),g=new i.Matrix4;g.extractRotation(h);const v=new i.Matrix4;v.copyPosition(h);const y=v.clone().invert().multiply(h),w=g.clone().invert().multiply(y),b=s,x=new i.Matrix4;if(0===d)x.copy(g).multiply(m).multiply(w).multiply(b);else if(1===d)x.copy(g).multiply(w).multiply(m).multiply(b);else{const t=(new i.Matrix4).scale((new i.Vector3).setFromMatrixScale(f)).clone().invert(),e=w.clone().multiply(t);x.copy(g).multiply(m).multiply(e).multiply(b)}const I=l.clone().invert(),M=a.clone().invert();let A=e.clone().multiply(c).multiply(l).multiply(n).multiply(r).multiply(o).multiply(I).multiply(u).multiply(a).multiply(s).multiply(M);const P=(new i.Matrix4).copyPosition(A),k=h.clone().multiply(P);return p.copyPosition(k),A=p.clone().multiply(x),A.premultiply(h.invert()),A}function Qe(t){const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(t=t||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[t]}function Ze(t){return t.split(",").map((function(t){return parseFloat(t)}))}function Ke(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=t.byteLength),i.LoaderUtils.decodeText(new Uint8Array(t,e,n))}function Ye(t,e,n){return t.slice(0,e).concat(n).concat(t.slice(e))}},7011:function(t,e,n){n.d(e,{L:function(){return d}});var r=n(2212);const i=/^[og]\s*(.+)?/,o=/^mtllib /,s=/^usemtl /,a=/^usemap /,u=new r.Vector3,c=new r.Vector3,l=new r.Vector3,h=new r.Vector3,f=new r.Vector3;function p(){const t={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(t,e){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=t,void(this.object.fromDeclaration=!1!==e);const n=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:!1!==e,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(t,e){const n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);const r={index:this.materials.length,name:t||"",mtllib:Array.isArray(e)&&e.length>0?e[e.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(t){const e={index:"number"===typeof t?t:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return e.clone=this.clone.bind(e),e}};return this.materials.push(r),r},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(t){const e=this.currentMaterial();if(e&&-1===e.groupEnd&&(e.groupEnd=this.geometry.vertices.length/3,e.groupCount=e.groupEnd-e.groupStart,e.inherited=!1),t&&this.materials.length>1)for(let n=this.materials.length-1;n>=0;n--)this.materials[n].groupCount<=0&&this.materials.splice(n,1);return t&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),e}},n&&n.name&&"function"===typeof n.clone){const t=n.clone(0);t.inherited=!0,this.object.materials.push(t)}this.objects.push(this.object)},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(t,e){const n=parseInt(t,10);return 3*(n>=0?n-1:n+e/3)},parseNormalIndex:function(t,e){const n=parseInt(t,10);return 3*(n>=0?n-1:n+e/3)},parseUVIndex:function(t,e){const n=parseInt(t,10);return 2*(n>=0?n-1:n+e/2)},addVertex:function(t,e,n){const r=this.vertices,i=this.object.geometry.vertices;i.push(r[t+0],r[t+1],r[t+2]),i.push(r[e+0],r[e+1],r[e+2]),i.push(r[n+0],r[n+1],r[n+2])},addVertexPoint:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addVertexLine:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addNormal:function(t,e,n){const r=this.normals,i=this.object.geometry.normals;i.push(r[t+0],r[t+1],r[t+2]),i.push(r[e+0],r[e+1],r[e+2]),i.push(r[n+0],r[n+1],r[n+2])},addFaceNormal:function(t,e,n){const r=this.vertices,i=this.object.geometry.normals;u.fromArray(r,t),c.fromArray(r,e),l.fromArray(r,n),f.subVectors(l,c),h.subVectors(u,c),f.cross(h),f.normalize(),i.push(f.x,f.y,f.z),i.push(f.x,f.y,f.z),i.push(f.x,f.y,f.z)},addColor:function(t,e,n){const r=this.colors,i=this.object.geometry.colors;void 0!==r[t]&&i.push(r[t+0],r[t+1],r[t+2]),void 0!==r[e]&&i.push(r[e+0],r[e+1],r[e+2]),void 0!==r[n]&&i.push(r[n+0],r[n+1],r[n+2])},addUV:function(t,e,n){const r=this.uvs,i=this.object.geometry.uvs;i.push(r[t+0],r[t+1]),i.push(r[e+0],r[e+1]),i.push(r[n+0],r[n+1])},addDefaultUV:function(){const t=this.object.geometry.uvs;t.push(0,0),t.push(0,0),t.push(0,0)},addUVLine:function(t){const e=this.uvs;this.object.geometry.uvs.push(e[t+0],e[t+1])},addFace:function(t,e,n,r,i,o,s,a,u){const c=this.vertices.length;let l=this.parseVertexIndex(t,c),h=this.parseVertexIndex(e,c),f=this.parseVertexIndex(n,c);if(this.addVertex(l,h,f),this.addColor(l,h,f),void 0!==s&&""!==s){const t=this.normals.length;l=this.parseNormalIndex(s,t),h=this.parseNormalIndex(a,t),f=this.parseNormalIndex(u,t),this.addNormal(l,h,f)}else this.addFaceNormal(l,h,f);if(void 0!==r&&""!==r){const t=this.uvs.length;l=this.parseUVIndex(r,t),h=this.parseUVIndex(i,t),f=this.parseUVIndex(o,t),this.addUV(l,h,f),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(t){this.object.geometry.type="Points";const e=this.vertices.length;for(let n=0,r=t.length;n<r;n++){const r=this.parseVertexIndex(t[n],e);this.addVertexPoint(r),this.addColor(r)}},addLineGeometry:function(t,e){this.object.geometry.type="Line";const n=this.vertices.length,r=this.uvs.length;for(let i=0,o=t.length;i<o;i++)this.addVertexLine(this.parseVertexIndex(t[i],n));for(let i=0,o=e.length;i<o;i++)this.addUVLine(this.parseUVIndex(e[i],r))}};return t.startObject("",!1),t}class d extends r.Loader{constructor(t){super(t),this.materials=null}load(t,e,n,i){const o=this,s=new r.FileLoader(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(n){try{e(o.parse(n))}catch(r){i?i(r):console.error(r),o.manager.itemError(t)}}),n,i)}setMaterials(t){return this.materials=t,this}parse(t){const e=new p;-1!==t.indexOf("\r\n")&&(t=t.replace(/\r\n/g,"\n")),-1!==t.indexOf("\\\n")&&(t=t.replace(/\\\n/g,""));const n=t.split("\n");let u="",c="",l=0,h=[];const f="function"===typeof"".trimLeft;for(let r=0,p=n.length;r<p;r++)if(u=n[r],u=f?u.trimLeft():u.trim(),l=u.length,0!==l&&(c=u.charAt(0),"#"!==c))if("v"===c){const t=u.split(/\s+/);switch(t[0]){case"v":e.vertices.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])),t.length>=7?e.colors.push(parseFloat(t[4]),parseFloat(t[5]),parseFloat(t[6])):e.colors.push(void 0,void 0,void 0);break;case"vn":e.normals.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]));break;case"vt":e.uvs.push(parseFloat(t[1]),parseFloat(t[2]))}}else if("f"===c){const t=u.substr(1).trim().split(/\s+/),n=[];for(let e=0,i=t.length;e<i;e++){const r=t[e];if(r.length>0){const t=r.split("/");n.push(t)}}const r=n[0];for(let i=1,o=n.length-1;i<o;i++){const t=n[i],o=n[i+1];e.addFace(r[0],t[0],o[0],r[1],t[1],o[1],r[2],t[2],o[2])}}else if("l"===c){const t=u.substring(1).trim().split(" ");let n=[];const r=[];if(-1===u.indexOf("/"))n=t;else for(let e=0,i=t.length;e<i;e++){const i=t[e].split("/");""!==i[0]&&n.push(i[0]),""!==i[1]&&r.push(i[1])}e.addLineGeometry(n,r)}else if("p"===c){const t=u.substr(1).trim().split(" ");e.addPointGeometry(t)}else if(null!==(h=i.exec(u))){const t=(" "+h[0].substr(1).trim()).substr(1);e.startObject(t)}else if(s.test(u))e.object.startMaterial(u.substring(7).trim(),e.materialLibraries);else if(o.test(u))e.materialLibraries.push(u.substring(7).trim());else if(a.test(u))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===c){if(h=u.split(" "),h.length>1){const t=h[1].trim().toLowerCase();e.object.smooth="0"!==t&&"off"!==t}else e.object.smooth=!0;const t=e.object.currentMaterial();t&&(t.smooth=e.object.smooth)}else{if("\0"===u)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+u+'"')}e.finalize();const d=new r.Group;d.materialLibraries=[].concat(e.materialLibraries);if(!0===!(1===e.objects.length&&0===e.objects[0].geometry.vertices.length))for(let i=0,o=e.objects.length;i<o;i++){const t=e.objects[i],n=t.geometry,o=t.materials,s="Line"===n.type,a="Points"===n.type;let u=!1;if(0===n.vertices.length)continue;const c=new r.BufferGeometry;c.setAttribute("position",new r.Float32BufferAttribute(n.vertices,3)),n.normals.length>0&&c.setAttribute("normal",new r.Float32BufferAttribute(n.normals,3)),n.colors.length>0&&(u=!0,c.setAttribute("color",new r.Float32BufferAttribute(n.colors,3))),!0===n.hasUVIndices&&c.setAttribute("uv",new r.Float32BufferAttribute(n.uvs,2));const l=[];for(let i=0,f=o.length;i<f;i++){const t=o[i],n=t.name+"_"+t.smooth+"_"+u;let c=e.materials[n];if(null!==this.materials)if(c=this.materials.create(t.name),!s||!c||c instanceof r.LineBasicMaterial){if(a&&c&&!(c instanceof r.PointsMaterial)){const t=new r.PointsMaterial({size:10,sizeAttenuation:!1});r.Material.prototype.copy.call(t,c),t.color.copy(c.color),t.map=c.map,c=t}}else{const t=new r.LineBasicMaterial;r.Material.prototype.copy.call(t,c),t.color.copy(c.color),c=t}void 0===c&&(c=s?new r.LineBasicMaterial:a?new r.PointsMaterial({size:1,sizeAttenuation:!1}):new r.MeshPhongMaterial,c.name=t.name,c.flatShading=!t.smooth,c.vertexColors=u,e.materials[n]=c),l.push(c)}let h;if(l.length>1){for(let t=0,e=o.length;t<e;t++){const e=o[t];c.addGroup(e.groupStart,e.groupCount,t)}h=s?new r.LineSegments(c,l):a?new r.Points(c,l):new r.Mesh(c,l)}else h=s?new r.LineSegments(c,l[0]):a?new r.Points(c,l[0]):new r.Mesh(c,l[0]);h.name=t.name,d.add(h)}else if(e.vertices.length>0){const t=new r.PointsMaterial({size:1,sizeAttenuation:!1}),n=new r.BufferGeometry;n.setAttribute("position",new r.Float32BufferAttribute(e.vertices,3)),e.colors.length>0&&void 0!==e.colors[0]&&(n.setAttribute("color",new r.Float32BufferAttribute(e.colors,3)),t.vertexColors=!0);const i=new r.Points(n,t);d.add(i)}return d}}}}]);